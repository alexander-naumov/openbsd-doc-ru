<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>4 - Руководство по установке OpenBSD 5.4</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "OpenBSD FAQ 4 - Installation Guide">
<meta name= "keywords"      content= "openbsd,faq4">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2013 by OpenBSD.">
</head>

<!-- Passes validator.w3.org.  Please keep it this way -->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../ru/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>

<font color= "#0000e0">
<a href= "index.html">[FAQ-Index]</a>
<a href= "faq3.html">[Глава 3 - Начинаем работать с OpenBSD]</a>
<a href= "faq5.html">[Глава 5 - Сборка системы из исходников]</a>
</font>

<h1><font color="#e00000">4 - Руководство по установке OpenBSD 5.4</font></h1>
<hr>

<p>
<h3>Содержание</h3>
<ul>
<li><a href= "#Overview"    >4.1 - Обзор процесса установки OpenBSD</a>
<li><a href= "#Checklist"   >4.2 - Предварительная подготовка</a>

<li><a href="#MkInsMedia"   >4.3 - Создание установочного носителя OpenBSD</a>
    <ul>
    <li><a href="#MkCD-ROM" >4.3.1 - Создание загрузочного CD</a>
    <li><a href="#UnixFlop" >4.3.2 - Создание дискет в UNIX</a>
    <li><a href="#DosFlop"  >4.3.3 - Создание дискет в Windows</a>
    </ul>
<li><a href="#Boot"         >4.4 - Загрузка c установочного носителя OpenBSD</a>
<li><a href="#Install"      >4.5 - Простая установка</a>
  <ul>
  <li><a href="#InstStart"    >4.5.1 - Начало установки</a>
  <li><a href="#InstQuestions">4.5.2 - Вопросы при установке</a>
  <li><a href="#InstDisks"    >4.5.3 - Настройка дисков</a>
  <li><a href="#InstMedia"    >4.5.4 - Выбор установочного носителя и набора файлов</a>
  <li><a href="#Inst1stBoot"  >4.5.5 - Первая загрузка!</a>
  <li><a href="#InstFinish"   >4.5.6 - Одна последняя вещь ...</a>
  </ul>

<li><a href="#More"         >4.6 - Подробнее о более сложной установке</a>
  <ul>
  <li><a href="#MoreNetwork"  >4.6.1 - Настройка сети</a>
  <li><a href="#MoreTimeZone" >4.6.2 - Настройка часового пояса</a>
  <li><a href="#Morefdisk"    >4.6.3 - Пользовательская разметка c fdisk(8)</a>
  <li><a href="#Moredisklabel">4.6.4 - Пользовательская разметка c disklabel</a>
  </ul>
<li><a href= "#FilesNeeded" >4.7 - Какие файлы нужны для установки?</a>
<li><a href= "#Partitioning">4.8 - Разметка диска</a>
<li><a href= "#Multibooting">4.9 - Мультизагрузка OpenBSD (amd64, i386)</a>
<li><a href= "#SendDmesg"   >4.10 - Отправка после установки вывода dmesg на dmesg@openbsd.org</a>
<li><a href= "#AddFileSet"  >4.11 - Добавление компонентов после установки</a>
<li><a href= "#bsd.rd"      >4.12 - Что такое 'bsd.rd'?</a>
<li><a href= "#InstProb"    >4.13 - Возможные проблемы при установке</a>
  <ul>
  <li><a href="#cpq16m"     >4.13.1 - Мой Compaq распознает только 16Мб RAM</a>
  <li><a href="#noboot"     >4.13.2 - Мой i386 не загружается после установки</a>
  <li><a href="#sshhang"    >4.13.3 - Моя (старая, медленная) машина загрузилась, но зависла на этапе генерации SSH-ключей</a>
  <li><a href="#noftplist"  >4.13.4 - При установке я получил сообщение "Не удалось изменить каталог" </a>
  <li><a href="#blankfdisk" >4.13.5 - В моей таблице разделов fdisk какой-то мусор или она пуста!</a>
  <li><a href="#noflopcd"   >4.13.6 - На моей машине нет дискеты или CD-ROM</a>
  <li><a href="#shamismatch">4.13.7 - Во время установки я получил расхождение SHA256!</a>
  </ul>
<li><a href= "#site"        >4.14 - Настройка процесса установки</a>
<li><a href= "#Multiple"    >4.15 - Как установить несколько одинаковых систем?</a>
<li><a href="#getdmesg"     >4.16 - Как я могу получить dmesg(8), чтобы сообщить о проблеме при установке?</h2>
</ul>
<hr>

<p>
<a name= "Overview"></a>
<h2>4.1 - Обзор процесса установки OpenBSD</h2>

<p>
OpenBSD давно пользуется уважением за простой процесс
установки, одинаковый для всех платформ.

<p>
На большинстве платформ процедура установки одинакова, 
однако, на некоторых из них все же встречаются незначительные отличия. 
В любом случае, мы рекомендуем вам ознакомиться с файлом INSTALL,
расположенным в каталоге требуемой <i>платформы</i> на CD-ROM или FTP
(например, <tt>i386/INSTALL.i386</tt>, <tt>macppc/INSTALL.macppc</tt> или
<tt>sparc/INSTALL.sparc</tt>).

<p>
Программа установки OpenBSD представляет собой <a href="#bsd.rd">специальное</a>
ядро с набором утилит и установочных скриптов, включенных в предварительно
загружаемый RAM диск.
После загрузки этого ядра, операционная система распаковывается из нескольких
сжатых 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
(<tt>.tgz</tt>) файлов, расположенных не на RAM диске. Есть несколько различных
способов загрузить установочное ядро:

<ul>
<li><b>Дискета:</b>
На многих платформах OpenBSD может быть установлена путем загрузки программы
инсталляции с одной дискеты. 
Для таких платформ, как i386 и sparc, загрузочной дискеты будет вполне достаточно,
однако, из-за нехватки места, установочные образы для некоторых других
платформ (sparc64, amd64, alpha) не включают в себя некоторые утилиты, возможно,
важные для вас, такие, например, как DHCP клиент для настройки сети.
Для этих платформ будет лучше использовать установочный CD.

<p>
Предоставляемые образы могут быть использованы для создания
установочной дискеты на другой <a href="#UnixFlop">UNIX-</a> или 
<a href="#DosFlop">Windows</a>-системе.

Обычно, этот файл называется <tt>floppy54.fs</tt>, хотя для некоторых
платформ может быть несколько образов.

<li><b>CD-ROM:</b> На некоторых платформах образ CD-ROM (<tt>cd54.iso</tt>
только для загрузки или <tt>install54.iso</tt> для полной установки)
предусматривает возможность создания загрузочного CD-ROM.

<li><b>Раздел на диске:</b> Ядро <a href="#bsd.rd">RAM диска</a> может быть
загружено из существующего раздела для обновления или переустановки.

<li><b>Сеть:</b> Некоторые платформы поддерживают загрузку по сети (например,
<a href="faq6.html#PXE">PXE</a> или другой способ
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">
загрузки по сети</a>).

<li><b>Записанный на диск образ файловой системы (miniroot):</b> Образ файловой
системы, который может быть записан на существующий раздел и затем загружен.

<li><b>Загрузочная лента:</b> Некоторый платформы поддерживают загрузку с ленты.
Создание этих лент описано в инструкциях INSTALL.<i>platform</i>.

</ul>

Не все <a href="../../ru/plat.html">платформы</a> поддерживают все изложенные
способы загрузки:

<ul>
<li><a href="../../alpha.html"><b>alpha:</b></a> Дискета, CD-ROM, сеть,
записанный на жесткий диск образ дискеты.

<li><a href="../../amd64.html"><b>amd64:</b></a> Дискета, CD-ROM,
<a href="faq6.html#PXE">сеть</a>.

<li><a href="../../armish.html"><b>armish:</b></a> Зависит от машины.

<li><a href="../../armv7.html"><b>armv7:</b></a> Запись образа на SD-карту.

<li><a href="../../aviion.html"><b>aviion:</b></a> Сеть, существующий раздел.

<li><a href="../../hp300.html"><b>hp300:</b></a> CD-ROM, сеть.

<li><a href="../../hppa.html"><b>hppa:</b></a> Сеть.

<li><a href="../../i386.html"><b>i386:</b></a> Дискета, CD-ROM,
<a href="faq6.html#PXE">сеть</a>.

<li><a href="../../landisk.html"><b>landisk:</b></a> Miniroot, установка
с помощью другого компьютера.

<li><a href="../../loongson"><b>loongson:</b></a> Miniroot, существующий раздел.

<li><a href="../../luna88k"><b>luna88k:</b></a> Сеть, загрузочная лента.

<li><a href="../../macppc.html"><b>macppc:</b></a> CD-ROM, сеть.

<li><a href="../../mvme68k.html"><b>mvme68k:</b></a> Сеть, загрузочная лента.

<li><a href="../../mvme88k.html"><b>mvme88k:</b></a> Сеть, загрузочная лента.

<li><a href="../../octeon.html"><b>octeon:</b></a> Сеть.

<li><a href="../../sgi.html"><b>sgi:</b></a> Сеть, CD-ROM.

<li><a href="../../socppc.html"><b>socppc:</b></a> Сеть.

<li><a href="../../sparc.html"><b>sparc:</b></a> Дискета, CD-ROM, сеть,
образ, записанный на существующий swap раздел, загрузочная лента.

<li><a href="../../sparc64.html"><b>sparc64:</b></a> Дискета (только U1/U2),
CD-ROM, сеть, образ, записанный на существующий раздел.

<li><a href="../../vax.html"><b>vax:</b></a> Дискета, сеть.

<li><a href="../../zaurus.html"><b>zaurus:</b></a> Загрузка bsd.rd из раздела
Linux.  Для получения подробностей обратитесь к 
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/5.4/zaurus/INSTALL.zaurus">
INSTALL.zaurus</a>.

</ul>

Все платформы могут так же использовать <a href="#bsd.rd">bsd.rd</a> для
переустановки или обновления.

<p>
После загрузки установочного ядра вы сможете выбрать откуда будет получен
<a href="#FilesNeeded">набор установочных файлов</a>.
Опять же, не все платформы поддерживают все предлагаемые варианты.

<ul>
<li><b>CD-ROM:</b> Конечно, мы предлагаем вам использовать 
<a href="../../orders.html">Официальный набор установочных CD-ROM</a>, но вы, также,
можете использовать <tt>install54.iso</tt> или собрать свой установочный набор.

<li><b>FTP:</b>
Любой из <a href="../../ru/ftp.html">FTP зеркал</a> или ваш локальный FTP сервер, 
содержащий набор установочных файлов.

<li><b>HTTP:</b>
Любой из <a href="../../ru/ftp.html#http">HTTP зеркал</a> или ваш локальный
веб-сервер, содержащий набор установочных файлов.

<li><b>Раздел локального диска:</b>
Во многих случаях, вы сможете установить наборы файлов из другого раздела жесткого
диска. Например, на платформе <a href="../../i386.html">i386</a> вы сможете
провести установку из FAT раздела или с CD-ROM, отформатированного в ISO9660, 
Rock Ridge или Joliet. Скорее всего, вам придется вручную примонтировать
файловую систему перед её использованием.

<li><b>NFS:</b>
Некоторые платформы поддерживают использование примонтированной NFS для 
получения установочных файлов.

<li><b>Лента:</b>
Установочные наборы файлов могут быть также считаны с ленты.
Узнать более подробно о созданиии такой ленты можно в документе
<tt>INSTALL.</tt><i>платформа</i>.
</ul>

<a name="Checklist"></a>
<h2>4.2 - Предварительная подготовка</h2>

<p>
Перед началом установки, вам необходимо иметь некоторое представление о том, 
что вы хотите получить в итоге.
По крайней мере, вам понадобится следующая информация:
<ul>
<li>Имя машины.
<li>Доступное и установленное оборудование:
  <ul>
  <li>Проверьте совместимость вашего оборудования на странице совместимости
      оборудования для вашей платформы.
  <li>Если используется ISA, вам также будет необходимо знать аппаратные настройки
      и подтвердить их при необходимости.
  </ul>
<li>Используемый метод установки (CD-ROM, FTP, и т.д.).
<li>Как исправить систему, если будет найдена важная ошибка?
  <ul>
  <li>Если все делать локально, вам понадобится 
      <a href="#Partitioning">место на диске</a> для размещения исходников и сборки.
  <li>В пртивном случае, вам понадобится доступ к другой машине для сборки
      исправленной <a href="faq5.html#Release">версии</a>.
  </ul>
<li>Желаемая структура разметки диска:
  <ul>
  <li>Есть ли на диске данные, которые необходимо сохранить в другом месте?
  <li>Будет ли OpenBSD сосуществовать в вашей системе с другой ОС?
      Если это так, то как будет загружаться каждая из систем?
      Нужно ли будет устанавливать загрузчик?
  <li>Будет ли использоваться для OpenBSD весь диск или вам нужно сохранить 
      существующий раздел/ОС (или оставить свободное место для использования в
      будущем)? 
  <li>Как вы хотите распределить раздел OpenBSD на вашем диске?
  </ul>
<li>Сетевые настройки, если не используется DHCP:
  <ul>
  <li>Доменное имя.
  <li>Адрес Сервера(ов) Доменных Имен(DNS).
  <li>IP адреса м маски подсети для каждого NIC.
  <li>Адрес шлюза.
  </ul>
<li>Будете ли вы запускать X Window System?
</ul>


<a name="MkInsMedia"></a>
<h2>4.3 - Создание установочного носителя OpenBSD</h2>

<p>
В качестве примера мы рассмотрим установочные образы, доступные для платформ
<a href="../../i386.html">i386</a> и <a href="../../sparc.html">sparc</a>. 
<p>
Для платформы <a href="../../i386.html">i386</a> существует шесть различных
образов установочных дисков:

<ul>
<li><b><tt>cd54.iso</tt></b> представляет собой ISO9660 образ, который
  может быть использован для создания загрузочного CD.
  Этот образ включает в себя широкий набор драйверов и обычно, если ваша 
  машина может загружаться с CDROM, является рекомендуемым.
 <li><b><tt>cdemu54.iso</tt></b> является ISO9660 образом, использующим 
  загрузку "эмуляции дискеты" с образом дискеты 2,88М.
  Остается надеяться, что немногие люди будут в нем нуждаться - большинство 
  будет использовать <tt>cd54.iso</tt>. Используйте <tt>cdemu54.iso</tt>
  только в том случае, если <tt>cd54.iso</tt> по каким-либо причинам у вас 
  не работает.
<li><b><tt>install54.iso</tt></b> представляет собой ISO9660 образ, содержащий
  все стандартные установочные файлы.
  Этот файл может быть использован для создания CD, обеспечивающего установку
  OpenBSD в автономном режиме.  
<li><b><tt>floppy54.fs</tt></b> (Настольные ПК) поддерживает множество
  PCI и ISA сетевых карт (NIC), IDE, SATA и простые SCSI-адаптеры, а также
  некоторые PCMCIA. Большинство пользователей при загрузке с дискеты
  будут использвать этот образ. 
<li><b><tt>floppyB54.fs</tt></b> (Серверы) поддерживает многие RAID-контроллеры
  и некоторые из менее распространенных SCSI-адаптеров.  Тем не менее, 
  поддержка многих стандартных SCSI-адаптеров и многих сетевых карт (NIC) 
  EISA и ISA была удалена.
<li><b><tt>floppyC54.fs</tt></b> (Ноутбуки) поддерживает CardBus и PCMCIA
  устройства, используемые во многих ноутбуках.
</ul>

<p>
 Для платформы <a href="../../sparc.html">sparc</a> предлагается четыре
 различных образа установочного диска:

<ul>
<li><b><tt>floppy54.fs</tt></b> предназначен для систем c floppy-дисководом.
<li><b><tt>cd54.iso</tt></b> представляет собой ISO-образ, предназначенный
    для создания CD для загрузки, оборудованных приводом CD-ROM, систем SPARC.
<li><b><tt>miniroot54.fs</tt></b> может быть записан в раздел swap и загружен.
<li><b><tt>install54.iso</tt></b> является образом ISO9660 и содержит все
    стандартные установочные файлы. Этот файл может быть использован для
    создания CD, обеспечивающем установку OpenBSD в автономном режиме.  
</ul>
Для современных платформ лучше всего использовать загрузочный образ CDROM,
в то время, как загрузочные образы дискет для некоторых "крупных" платформ
не содержат многих драйверов и утилит, что может усложнить установку.
На более старые платформы, такие как i386 и sparc, по-прежнему можно успешно 
установить операционную систему с дискеты. 

<p>
<a name="MkCD-ROM"></a>
<h3>4.3.1 - Создание загрузочного CD</h3>

<p>
Для создания CD-ROM можно использовать файлы образов <tt>cd54.iso</tt> или
<tt>install54.iso</tt>.
Детали по созданию CD приводятся здесь, выбор же инструментов для этого,
оставляем читателям.

<p>
В OpenBSD можно создать CD из ISO образа с помощью
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">
cdio(1)</a>:

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cdio tao cd54.iso</b>
</pre></td></tr></table>

<p>
К большинству пишущих приводов CD, продающихся для Windows и Macintosh систем,
прилагается программное обеспечение для записи ISO-образов. Если у вас его нет,
существуют различные бесплатные приложения,
которые можно использовать для записи.

<p>
Другие UNIX-подобные системы используют такие приложения, как:
<a href="http://www.cdrkit.org/">cdrkit</a>.

<p>
<a name="MkFlop"></a>
<a name="UnixFlop"></a>
<h3>4.3.2 - Создание дискет в UNIX</h3>

<p>
Конкретные детали и имена устройств могут отличаться в разных UNIX-системах;
используйте то, что подходит для вашей системы.  

<p>
Для форматирования дискеты и проверки плохих секторов можно воспользоваться
коммандой
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&amp;sektion=1&amp;arch=i386">
fdformat(1)</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>fdformat /dev/rfd0c</b>
  Format 1440K floppy `/dev/rfd0c'? (y/n): y
  Processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</pre></td></tr></table>

<p>
Если на экране вы увидите вывод комманды, похожий на приведенный выше, значит
с дискетой все в порядке.
Однако, если вы не увидите ВСЕ "V", значит дискета, скорее всего, повреждена и
ее необходимо заменить.

<p>
Для записи файла образа на диск, используйте 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=0">
dd(1)</a>. Пример использования <tt>dd(1)</tt> приведен ниже:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>dd if=floppy54.fs of=/dev/rfd0c bs=32k</b>
</pre></td></tr></table>

<p>
После того, как образ будет записан, проверьте идентичность записанного
образа оригиналу с помощью команды
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cmp&amp;sektion=1">
cmp(1)</a>. Если, в результате выполнения команды вы просто увидите командную
строку, значит дискета идентична образу.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cmp /dev/rfd0c floppy54.fs</b>
</pre></td></tr></table>

<p>
<a name="DosFlop"></a>
<h3>4.3.3 - Создание дискет в Windows</h3>

<p>
Чтобы подготовить дискету в Windows, сначала её следует отформатировать.
Следует также убедиться, что диск не имеет плохих секторов.  

<p>
Для записи установочного образа на подготовленную дискету можно 
использовать программу <tt>ntrw.exe</tt>, которую можно загрузить из
каталога <a href="ftp://ftp.openbsd.org/pub/OpenBSD/5.4/tools/">tools</a>
на любом из FTP-зеркал.


<p>
Пример использования <i>ntrw</i>:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>ntrw floppy54.fs a:</strong>
  3.5", 1.44MB, 512 bytes/sector
  bufsize is 9216
  1474560 bytes written
</pre></td></tr></table>

<p>
<a name="Boot"></a>
<h2>4.4 - Загрузка c установочного носителя OpenBSD</h2>

<h3>Загрузка i386/amd64</h3>

Загрузка с установочного носителя на платформах i386 и amd64 для большинства
пользователей не содержит в себе ничего нового.
Ваша система должна быть настроена на загрузку с нужного носителя, обычно,
это устанавливается в BIOS.
Если вы хотите загрузиться с CD, ваш BIOS должен поддерживать и быть настроен
на загрузку с CD.
Некоторые устаревшие системы не имеют этой возможности и вам придется 
использовать дискету для загрузки установочного образа.
Не беспокойтесь по этому поводу, даже, если вам придется загружаться
с дискеты, вы сможете продолжить установку с CD, если это поддерживается 
OpenBSD (то есть, это практически все IDE диски).

<p>
Так же, можно установить операционную систему, загрузив 
<a href="#bsd.rd">bsd.rd</a> из существующего раздела OpenBSD, или по сети,
используя <a href="faq6.html#PXE">процесс загрузки PXE</a>.

<h3>Загрузка sparc/sparc64</h3>

<b>ПРИМЕЧАНИЕ:</b>
Загрузиться с дискеты на платформе <a href="../../sparc64.html">sparc64</a> 
можно только на машинах SBus (Ultra 1, Ultra 2).

<p>
Необходимо, чтобы система на мониторе отобразила ROM-строку, которая
обычно выглядит, как "ok".
Если вы используете клавиатуру Sun, нажмите и удерживайте "STOP", в то же
время, нажав "А".
При использовании последовательной консоли, нажатие BREAK вернет вас к
строке монитора.

<p>
Для загрузки с дискеты используйте следующую команду:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot floppy</b>
</pre></td></tr></table>

<p>
Обычно, на системе Sun можно загрузиться с CDROM из командной строки, 
если ввести '<tt>boot cdrom</tt>':

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot cdrom</b>
</pre></td></tr></table>

<p>
<a name="Install"></a>
<h2>4.5 - Простая установка</h2>
Новый инсталлятор OpenBSD предназначен для установки и автоматической
настройки системы практически без вмешательства пользователя.
Вы можете просто несколько раз нажать <i>ENTER</i>, чтобы установить
OpenBSD. В конце вам придется лишь ввести пароль root.

<p>
Программа инсталляции предложит схему разделов на жестком диске, исходя
из его размера.
Хотя эта схема может и не подойти вам, она послужит хорошей отправной
точкой и хорошей общей стратегией для создания того, что вам нужно.

<p>
Мы начнем с очень простой установки, кратко поясняя возможные варианты, 
а использование приводящихся в тексте гиперссылок, позволит вам получить
дополнительную информацию по интересующим вас деталям.

<p>
Замечания по установке для каждой платформы находятся на установочных CD
и FTP-серверах в файле <tt>INSTALL.<i>&lt;плат&gt;</i></tt>, где
<i>&lt;плат&gt;</i> это ваша <a href="../../plat.html">платформа</a>,
например, <tt>i386</tt>.

<p>
<a name="InstStart"></a>
<h3>4.5.1 - Начало установки</h3>
Какой бы метод вы ни использовали для установки OpenBSD, настало
время её произвести. Во время процесса загрузки, ядро и все программы,
используемые для установки, загружается в память. После того, как
установочное ядро будет загружено, загрузочный носитель больше не нужен
- все остальное запускается с RAM диска. Вы можете извлечь CD или дискету,
с которой загрузились, если вам не нужен этот CD для установки файлов.

<p>
В любой момент процесса установки OpenBSD, вы можете, нажав CTRL-C, 
завершить текущую попытку установки, а, выполнив <tt>install</tt> в 
командной строке оболочки, перезапустить установку без перезагрузки.
Вы также можете ввести "!" в большинстве мест в установке, чтобы получить
доступ к командной строке, а затем выйти из оболочки и вернуться к 
программе установки.

<p>
При успешой загрузке вы увидите много выводимых на экран текстовых сообщений.
На большинстве архитектур это текст белого цвета на синем фоне, являющися ни чем
иным, как 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">
dmesg</a> выводом ядра с информацией о том, какие устройства были обнаружены.
Копия этих текстовых сообщений сохраняется как <tt>/var/run/dmesg.boot</tt>.

<p>
Далее вы увидите следующее:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ...
  root on rd0a swap on rd0b dump on rd0b
  erase ^?, werase ^W, kill ^U, intr ^C, status ^T

  Welcome to the OpenBSD/i386 5.4 installation program.
  (I)nstall, (U)pgrade or (S)hell? <b>i</b>
</pre></td></tr></table>

<p>
И вот, мы приходим к первому вопросу. Вы увидите три варианта для выбора: 

<ul>
<li><b>Install:</b> Установка OpenBSD на вашу систему, которая перезапишет
    все, что там было. Обратите внимание, что при этом можно оставить некоторые
    разделы, такие как <tt>/home</tt>, нетронутыми, но остальные будут 
    перезаписаны.

<li><b>Upgrade:</b> Установка нового набора <a href="#FilesNeeded">инсталляционных
    файлов</a> без перезаписи какой-либо конфигурационной информации, пользовательских
    данных или установленных приложений. Также, не будет произведено форматирование 
    диска, равно как и не будет перезаписано содержимое каталогов <tt>/etc</tt> или
    <tt>/var</tt>. Несколько важных замечаний:
<ul>
<li>У вас не будет возможности установить файл <tt>etc54.tgz</tt>. После установки
    нужно будет <a href="../upgrade54.html#etcUpdates">вручную объединить</a> изменения
    в <tt>etc54.tgz</tt> с вашей системой для приведения её в полностью работоспособное
    состояние. Этот шаг обязательно должен быть выполнен, иначе некоторые важные сервисы 
    (такие как <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">
    pf(4)</a>) могут не запуститься.

<li>Процесс Обновления (Upgrade) не рассчитан на пропуск релизов! Хотя это может
    сработать, такой процесс не является поддерживаемым. Для OpenBSD 5.4, обновление
    версии 5.3 до 5.4 - единственное поддерживаемое обновление. Если вы хотите обновиться
    с более старой версии, сначала обновитесь до промежуточных версий или, если ваша
    система очень устарела, подумайте о полной переустановке.

</ul>
<!-- XXXversion -->
<li> Больше информации об обновлении между версиями можно получить в 
<a href="../upgrade54.html">Руководстве по обновлению OpenBSD 5.4
(OpenBSD Upgrade Guide 5.4)</a>.

<li><b>Shell:</b> В случае, если ваша система не загружается нормальным способом,
    вы можете произвести восстановление/обслуживание системы с помощью этой опции.
    Выбор этого варианта позволит проводить обслуживание системы. На загрузочном носителе
    доступен набор ключевых утилит. 
</ul>

Мы предполагаем, что вы выбрали "(I)nstall".

<p>
<a name="InstQuestions"></a>
<h3>4.5.2 - Вопросы при установке</h3>
Итак, сейчас нам будут заданы вопросы, по ответам на которые будет 
определено, как будет настроена система. Вы заметите, что в большинстве
случаев сначала задаются вопросы, затем выполняется установка.
Если у вас слабый компьютер или медленное подключение к интернет, 
вы сможете ответить на эти вопросы, уйти, вернуться позже, и только 
перезагрузить систему для завершения установки.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  At any prompt except password prompts you can escape to a shell by
  typing '!'. Default answers are shown in []'s and are selected by
  pressing RETURN.  You can exit this program at any time by pressing
  Control-C, but this can leave your system in an inconsistent state.

  Choose your keyboard layout ('?' or 'L' for list) [default] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Если вы не выберете раскладку клавиатуры (или тип терминала, если установлена
последовательная консоль), будет использоваться раскладка US.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  System hostname? (short form, e.g. 'foo') <i><b>puffy</b></i>
</pre></td></tr></table>

<p>
Это значение, наряду с именем DNS (определяется <a href="#MoreNetwork">ниже</a>),
будет сохранено в файл <tt>/etc/myname</tt>, который используется в процессе
обычной загрузки для установки имени хоста системы.
Если не установить доменное имя, будет использовано значение "my.domain".

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available network interfaces are: fxp0 vlan0.
  Which one do you wish to configure? (or 'done') [fxp0] <i><b>Enter</b></i>  
</pre></td></tr></table>

<p>
<tt>vlan0</tt> представляет собой виртуальный интерфейс VLAN. Сейчас мы
пропустим этот вариант и сконцентрируемся на физических интерфейсах.
Если у вас их несколько, они будут здесь перечислены. Обратите внимание,
что они идентифицируются по имени драйвера, а не как общие устройства Ethernet.
В данном случае, "<tt>fxp0</tt>" является первым устройством, использующим
драйвер <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fxp&amp;sektion=4">
fxp(4)</a>, <tt>fxp1</tt> будет вторым устройством и т.д. Подробнее об именах
устройств можно узнать в <a href="faq6.html#Setup.if">FAQ 6</a>.

<p>
После выбора устройства, сразу же переходим к его настройке.
В большинстве случаев, вам нужно будет выбрать настройку с использованием DHCP:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IPv4 address for fxp0? (or 'dhcp' or 'none') [dhcp] <b><i>Enter</i></b>
  Issuing hostname-associated DHCP request for fxp0.
  DHCPDISCOVER on fxp0 to 255.255.255.255 port 67 interval 1
  DHCPOFFER from 192.168.1.250 (08:00:20:94:0b:c8)
  DHCPREQUEST on fxp0 to 255.255.255.255 port 67
  DHCPACK from 192.168.1.250 (08:00:20:94:0b:c8)
  bound to 192.168.1.199 -- renewal in 43200 seconds.
</pre></td></tr></table>

<p>
DHCP сконфигурирует IP адрес, маску подсети, шлюз и DNS.
Если вы не используете DHCP, необходимо будет указать все эти настройки 
вручную; более детально смотрите обсуждение 
<a href="#MoreNetwork">ниже</a>.
<a name="backMoreNetwork"></a>

<p>
Если вам необходимы какие-либо IPv6 настройки или нужно настроить другие 
интерфейсы (или вам не нравиться, как настроен предыдущий интерфейс),
вы можете это сделать прямо сейчас, но в данном случае мы делаем следующее:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IPv6 address for fxp0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
  Available network interfaces are: fxp0 vlan0.
  Which one do you wish to configure? (or 'done') [done] <b><i>Enter</i></b>
  Using DNS domainname example.org
  Using DNS nameservers at 192.168.1.252
  Do you want to do any manual network configuration? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Если вы ответите "yes" на последний вопрос, то попадете в консоль,
где сможете настроить все, что считаете необходимым. Затем введите
"exit" для возврата в программу установки.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Password for root account? (will not echo) <i>PaSsWoRd</i>
  Password for root account? (again) <i>PaSsWoRd</i>
</pre></td></tr></table>

<p>
Для учетной записи root используйте надежный пароль. Помните, что на ваш
компьютер можно будет зайти из сети. Для этого надо будет лишь подобрать
верный пароль.

<p>
Позже вы сможете создать административную учетную запись и отключить
удаленный доступ (SSH) к root аккаунту, но надежный пароль для учетной 
записи root все равно необходим.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start sshd(8) by default? [yes] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
sshd(8) можно запускать при старте системы, но, если он вам не нужен,
то его отключение даст небольшое теоретическое преимущество для безопасности.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start ntpd(8) by default? [no] <b>y</b>
  NTP server? (hostname or 'default') [default] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Здесь вам предоставляется возможность разрешить запуск
<a href="faq6.html#OpenNTPD">OpenNTPD</a> - реализация NTP в OpenBSD.
OpenNTPD является низкозатратным способом поддерживать часы вашего
компьютера точно синхронизированными.
В конфигурации по умолчанию используется 
<a href="http://www.pool.ntp.org">pool.ntp.org</a>, который используют
большинство общедоступных серверов времени по всему миру.

<p>
Одной из причин, по которой не стоит запускать ntpd(8), является
использование <a href="#Multibooting">мультизагрузки</a>. В этом случае
используется другая ОС, которая не использует GMT в аппаратных часах, и вы
не хотели бы, чтобы OpenBSD изменяла время другой ОС.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you expect to run the X Window System? [yes] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Не на всех платформах будет задан вопрос о запуске X Window System, а только 
на тех, которым требуется установка sysctl для использования X.
Ответ "yes" повлечет за собой изменение <tt>/etc/sysctl.conf</tt>, в 
который будет добавлена строка <tt>machdep.allowaperture=1</tt> или
<tt>machdep.allowaperture=2</tt> (в зависимости от вашей платформы).

<p>
Если вы не планируете запускать Х на вашей системе или не уверены, ответьте 
здесь 'N'. Эти настройки можно будет изменить позже, отредактировав 
<tt>/etc/sysctl.conf</tt>. Оставляя драйвер
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">
xf86(4)</a> отключенным, вы потенциально улучшаете безопасность системы, так как 
графический движок для современной видео карты потенциально может быть
использован для изменения памяти в обход контроля со стороны процессора.
Обратите внимание, что "неграфические" приложения, которые используют 
для работы библиотеки и утилиты Х, НЕ требуют установки sysctl.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want the X Window System to be started by xdm(1)? [no] <b>y</b>
</pre></td></tr></table>

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>
запускает X-окружение при загрузке системы. Мы рекомендуем его использовать,
если вы уверены, что Х будет работать на вашей системе.
В противном случае, <a href="faq11.html">настройте X</a> перед использованием
xdm(1).

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Setup a user? (enter a lower-case loginname, or 'no') [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Тут вы можете создать обычного пользователя (ОТЛИЧНОГО от root).
Этот пользователь будет входить в группу "wheel", т.е. сможет использовать
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a>
и получать почту, адресованную root.

<p>
Если вы хотите создать пользователя, введите имя пользователя, а не "y" или "yes".

<a name="InstDisks"></a>
<h3>4.5.3 - Настройка дисков</h3>

<i><b>Важное замечание:</b>
Пользователям, которые используют жесткие диски большой емкостью
(большей, чем доступные в то время, когда был выпущен компьютер),
будет полезно ознакомиться <a href="faq14.html#LargeDrive">с этим
разделом</a>.</i>

<p>
Правильная разметка диска, пожалуй, самая трудная часть установки OpenBSD.

<p>
Настройка дисков в OpenBSD немного отличается между платформами.
Для <a href="../i386.html">i386</a>, <a href="../amd64.html">amd64</a>,
<a href="../macppc.html">macppc</a>, <a href="../zaurus.html">zaurus</a>
и <a href="../armish.html">armish</a>,
настройка дисков происходит в два этапа.
Сначала, используя fdisk(8), на жестком диске выделяется слайс для OpenBSD,
затем этот слайс при помощи disklabel(8) разбивается на разделы OpenBSD.

<p>
Некоторых пользователей может несколько смутить данная терминология.
Вы заметите, что мы будем использовать термин "раздел" в двух различных смыслах.
Да, это так.
Для перечисленных выше платформ в OpenBSD есть два уровня партиционирования.
Первый можно назвать уровнем ОС, т.е. методом разметки своего пространства
для каждой ОС. Второй определяет разбиение раздела OpenBSD на подразделы с
отдельными файловыми системами. Результат первого уровня мы сможем увидеть из
DOS, Windows и любой другой ОС, понимающей такую схему партиционирования.
Второй уровень виден только из OpenBSD и тех ОС, которые понимают и могут
напрямую работать с файловой системой OpenBSD.
(Стоит отметить, что именно для избежания такой путаницы, когда требуется
одновременно обсуждать разделы обоих уровней, разделы первого уровня называются
слайсами, и лишь разделы второго уровня собственно разделами - прим. пер.)

<p>
Программа установки OpenBSD старается упростить процесс создания разделов
на диске, используя установки по умолчанию, которые подходят для "общих" задач.
Следует отметить, что несмотря на то, что каждый может создать свою собственную
таблицу разделов, новичкам все же стоит начать с использования настроек
по умолчанию. Во всяком случа до того, пока они не будут четко представлять
почему это им не подходит. Отметим так же, что структура разметки по умолчанию
будет меняться в зависимости от размера вашего диска.

<p>
Предположим, на данный момент, у нас есть диск размером 40 Гб.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available disks are: wd0.
  Which one is the root disk? (or 'done') [wd0] Enter
  Use DUIDs rather than device names in fstab? [yes] <i><b>Enter</b></i>
  Disk: wd0       geometry: 5221/255/63 [40960 Megabytes]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 06      0   1   1 -    521 254  63 [          63:     8385867 ] DOS > 32MB
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Use (W)hole disk or (E)dit the MBR? [whole] <i><b>Enter</b></i>
  Setting OpenBSD MBR partition to whole wd0...done.
</pre></td></tr></table>

<p>
Обратите внимание, что на этом диске уже есть раздел и, при  выборе 
<i>"using whole disk"</i> (использовать весь диск), он будет удален!

<p>
Использование всего диска повлечет за собой:
<ul>
<li>Будут стерты все существующие на диске разделы. 
<li>Будет создана MBR и информация на диске о том, что он является загрузочным.
<li>На всем диске будет создан раздел OpenBSD.
<li>Этот раздел будет установлен как "active".
</ul>

Не стоит использовать весь диск, если:
<ul>
<li>Вы хотите сохранить разделы другой ОС.
<li>Вы хотите сохранить "setup", "suspend to disk", или другие разделы 
системы.
<li>Вы хотите получить в итоге <a href="#Multibooting">мультизагрузочную</a>
систему.
</ul>

Обратите внимание, что новый (или никогда не использовавшийся для загрузки)
диск имел правильный MBR, правильную подпись OpenBSD раздела и установленный
флаг "active".
Если вы не используете для установки весь диск ("use whole disk"), то не
забудьте проверить эти настройки.

<p>
Дополнительную информацию об использовании fdisk для работы с разделами можно
найти <a href="#Morefdisk">ниже</a>.
<a name="BackMorefdisk"></a>

<p>
Итак, приступим, используя
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">
disklabel(8)</a>, к созданию разделов внутри слайса, созданного до этого при
помощи fdisk:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Setting OpenBSD MBR partition to whole wd0...done.
  The auto-allocated layout for wd0 is:
  #                size           offset  fstype [fsize bsize  cpg]
    a:          1024.0M               64  4.2BSD   2048 16384    1 # /
    b:           199.0M          2097216    swap                   
    c:         40960.0M                0  unused                   
    d:          2822.9M          2504768  4.2BSD   2048 16384    1 # /tmp
    e:          4295.0M          8286112  4.2BSD   2048 16384    1 # /var
    f:          2048.0M         17082240  4.2BSD   2048 16384    1 # /usr
    g:          1024.0M         21276544  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          5426.7M         23373696  4.2BSD   2048 16384    1 # /usr/local
    i:          1699.7M         34487520  4.2BSD   2048 16384    1 # /usr/src
    j:          2048.0M         37968576  4.2BSD   2048 16384    1 # /usr/obj
    k:         20367.4M         42162880  4.2BSD   2048 16384    1 # /home
  Use (A)uto layout, (E)dit auto layout, or create (C)ustom layout? [a] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Программа установки предлагает использовать для раздела OpenBSD настройки
по умолчанию ("Auto layout"), с чем мы соглашаемся.

<p>
Если предлагаемая схема вам не подходит, вы, конечно же, можете её
отредактировать или изменить полностью. Более подробно о создании разделов
можно узнать <a href="#Moredisklabel">ниже</a>.
<a name="BackMoredisklabel"></a>

<p>
<b>ЗАМЕЧАНИЯ для переустановки:</b>
Новый инсталлятор при выборе "(C)ustom Layout" не будет очищать 
имеющуюся разметку раздела, но вам нужно будет повторно указать точки
монтирования, используя  в disklabel(8) опцию 'm'.

<p>
Сейчас программа установки создаст эти разделы и, с помощью  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs&amp;sektion=8">newfs(8)</a>,
файловые системы на них, а также, примонтирует разделы для установки: 

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  /dev/rwd0a: 1024.0MB in 2097152 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0k: 20367.4MB in 41712448 sectors of 512 bytes
  101 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0d: 2822.9MB in 5781344 sectors of 512 bytes
  14 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0f: 2048.0MB in 4194304 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0g: 1024.0MB in 2097152 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0h: 5426.7MB in 11113824 sectors of 512 bytes
  27 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0j: 2048.0MB in 4194304 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0i: 1699.7MB in 3481056 sectors of 512 bytes
  9 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0e: 4295.0MB in 8796128 sectors of 512 bytes
  22 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local)
  /dev/wd0k on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0f on /mnt/usr type ffs (rw, asynchronous, local, nodev)
  /dev/wd0g on /mnt/usr/X11R6 type ffs (rw, asynchronous, local, nodev)
  /dev/wd0h on /mnt/usr/local type ffs (rw, asynchronous, local, nodev)
  /dev/wd0j on /mnt/usr/obj type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0i on /mnt/usr/src type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid)</pre>
</td></tr></table>

<p>

Обратили внимание, что раздел "<i>c</i>" нами не использован?
Этот раздел - весь наш диск; не пытайтесь его использовать.

<p>
<a name="InstMedia"></a>
<h3>4.5.4 - Выбор установочного носителя и набора файлов</h3>

Далее вы должны указать используемый установочный носитель.
В данном случае мы будем производить установку с FTP.
<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Location of sets? (cd disk ftp http or 'done') [cd] <b>ftp</b>
  HTTP/FTP proxy URL? (e.g. 'http://proxy:8080', or 'none') [none] <b><i>Enter</i></b>
  Server? (hostname, list#, 'done' or '?') [mirror.example.org] <b>obsd.cec.mtu.edu</b>
</pre></td></tr></table>

<p>
Если вы не можете вспомнить имя зеркала (предпочитаемое вами или любое другое),
программа установки будет использовать зеркало по умолчанию.
В противном случае, нажмите "?" для получения списка зеркал и выберите 
номер зеркала, которое хотите использовать.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Server directory? [pub/OpenBSD/5.4/i386] <b><i>Enter</i></b>
  Login? [anonymous] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Все общедоступные FTP-зеркала поддерживают анонимный доступ, но у вас
может быть и локальная машина, которая требует авторизации
(т.е. использование логина и пароля).

<p>
Теперь вы можете настроить список <a href="#FilesNeeded">набора файлов</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Select sets by entering a set name, a file name pattern or 'all'. De-select
  sets by prepending a '-' to the set name, file name pattern or 'all'. Selected
  sets are labelled '[X]'.
      [X] bsd           [X] etc54.tgz     [X] xbase54.tgz   [X] xserv54.tgz
      [X] bsd.rd        [X] comp54.tgz    [X] xetc54.tgz
      [ ] bsd.mp        [X] man54.tgz     [X] xshare54.tgz
      [X] base54.tgz    [X] game54.tgz    [X] xfont54.tgz
  Set name(s)? (or 'abort' or 'done') [done] <b><i>Enter</i></b>
</pre></td></tr></table>


<p>
Как минимум, вам необходимо ядро (<tt>bsd</tt>), наборы файлов
base54.tgz и etc54.tgz.
Если вы не знаете, что делать, используйте наборы файлов, предложенные 
по умолчанию.
Вы можете добавлять и удалять наборы файлов, используя символы "+" и "-" 
перед именем набора, можно также использовать шаблоны:
<ul>
<li><tt><b>-comp54.tgz</b></tt> удалит <tt>comp54.tgz</tt>
<li><tt><b>+bsd.mp</b></tt> добавит bsd.mp
<li><tt><b>-x*</b></tt> удалит все компоненты X
</ul>

Опять же, мы оставляем все по умолчанию.
Наша машина имеет один процессор, поэтому bsd.mp не предлагается устанавливать, 
но все остальное в списке есть.
Если в дальнейшем в систему будет добавлен процессор, вы сможете без проблем
доустановить bsd.mp.

<p>
И вот настал этап, к которому готовил нас установщик OpenBSD! Самое время
установить выбранные выше компоненты в соответствии с произведенными настройками.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  bsd          100% |*************************************|  9399 KB    00:05
  bsd.rd       100% |*************************************|  6350 KB    00:03
  base54.tgz   100% |*************************************| 55803 KB    00:26
  etc54.tgz    100% |*************************************|   511 KB    00:00
  comp54.tgz   100% |*************************************| 47533 KB    00:28
  man54.tgz    100% |*************************************|  9761 KB    00:06
  game54.tgz   100% |*************************************|  2568 KB    00:02
  xbase54.tgz  100% |*************************************| 10562 KB    00:06
  xetc54.tgz   100% |*************************************| 64774       00:00
  xshare54.tgz 100% |*************************************|  4373 KB    00:04
  xfont54.tgz  100% |*************************************| 38869 KB    00:17
  xserv54.tgz  100% |*************************************| 25954 KB    00:15

  Location of sets? (cd disk ftp http or 'done') [done] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Да, вопрос о том, откуда вы хотите их установить, задается еще раз.
Это сделано для того, чтобы можно было переустановить какой-либо набор
файлов, если вы что-то пропустили, забыли или не смогли установить, а также
для установки <a href="#site">пользовательских наборов</a> файлов.

<p>
Мы используем наборы по умолчанию и завершаем установку.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Saving configuration files...done.
  Generating initial host.random file...done.
  Making all device nodes...done.

  CONGRATULATIONS! Your OpenBSD install has been successfully completed!
  To boot the new system, enter 'reboot' at the command prompt.
  When you login to your new system the first time, please read your mail
  using the 'mail' command.

  #
</pre></td></tr></table>
<p>

<a name="Inst1stBoot"></a>
<h3>4.5.5 - Первая загрузка!</h3>
Сейчас OpenBSD установлена на вашу систему и  готова для своей первой
загрузки, но перед тем, как это сделать ...

<p>

<h4>Перед перезагрузкой</h4>
Ваша система установлена, готова к перезагрузке и 
настроена для работы, но, перед тем как это сделать, загляните на
<a href="../../errata54.html">errata-страницу</a>, чтобы
просмотреть ошибки, с которыми можете сразу же столкнуться.

<h4>После перезагрузки</h4>

При первой загрузке будут сгенерированы ключи 
<a href="http://www.openssh.com">SSH</a>.
На новых компьютерах это займет несколько секунд, и вы можете даже
не заметить этого.
На старых системах это может занять несколько минут, а на действительно
медленных машинах возможно даже час или больше.

<p>
После перезагрузки стоит сразу ознакомиться с 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">
afterboot(8)</a>.

<p>
Также могут показаться полезными следующие ссылки:
<ul>
<li><a href="faq10.html#AddDelUser">Добавление пользователей в OpenBSD</a>
<li><a href="faq6.html#Setup">Начальная настройка сети</a>
<li><a href="faq2.html#ManPages">Страницы Руководств популярных/полезных
 команд</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi">Страницы руководств
  OpenBSD в Web</a>
<li><a href="faq15.html">Система Пакетов и Портов OpenBSD для установки
   программного обеспечения</a>
</ul>

<a name="InstFinish"></a>
<h3>4.5.6 - Одна последняя вещь ...</h3>

Разработчики OpenBSD будут очень вам признательны, если вы <a href="#SendDmesg">
отправите им вывод dmesg</a>. Это действительно очень необходимо разработчикам,
да и, в конечном счете, всем пользователям.

<p>
<a name="More"></a>
<h2>4.6 - Подробнее о более сложной установке</h2>
Не всегда все так гладко и просто. Не всегда вам подходят настройки по умолчанию.
Здесь приведены некоторые подробности процесса установки.

<p>
<a name="MoreNetwork"></a>
<h3>4.6.1 - Настройка сети</h3>

Если вы не используете DHCP, вам придется настраивать сеть вручную.
Пример:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Which one do you wish to configure? (or 'done') [xl0] <b><i>Enter</i></b>
  IPv4 address for xl0? (or 'dhcp' or 'none') [dhcp] <b>192.168.1.37</b>
  Netmask? [255.255.255.0] 255.255.254.0
  IPv6 address for xl0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
После настройки (по средствам заданных вопросов) одной сетевой карты или
адаптера у вас будет возможность настроить остальные, имеющиеся в вашей системе.
Если вы укажете имя другой сетевой карты, вопросы естественно будут заданы снова.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available network interfaces are: xl0 vlan0.
  Which one do you wish to configure? (or 'done') [done]
</pre></td></tr></table>

<p>
Сейчас нужно будет указать адрес шлюза и DNS сервера - компонентов сети,
влияющих на всю сетевую систему ОС:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Default IPv4 route? (IPv4 address, 'dhcp' or 'none') <b>192.168.1.1</b>
  add net default: gateway 192.168.1.1
  DNS domain name? (e.g. 'bar.com') [my.domain] <b>example.org</b>
  DNS nameservers? (IP address list or 'none') [none] <b>192.168.1.250 192.168.1.251</b>
</pre></td></tr></table>

<p>
Обратите внимание, что можно перечислить несколько DNS, разделяя их адреса пробелами.

<p>
Иногда вам может понадобиться сделать нечто большее, чем, например, просто настроить доступ к 
беспроводной сети или установить дуплексный режим или скорость передачи данных
(не делайте этого, если в этом нет абсолютной НЕОБХОДИМОСТИ, исправление конфигурации
свича будет лучшей идеей!).
Сейчас предоставляется возможность с помощью интерпретатора shell вручную настроить все,
что вам необходимо. 

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want to do any manual network configuration? [no] <b>y</b>
  Type 'exit' to return to install.
  # <b>ifconfig xl0 media</b>
  xl0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
          lladdr 00:08:74:2c:df:9c
          groups: egress
          media: Ethernet autoselect (100baseTX full-duplex)
          status: active
          supported media:
                  media 10baseT
                  media 10baseT mediaopt full-duplex
                  media 100baseTX
                  media 100baseTX mediaopt full-duplex
                  media autoselect
          inet 192.168.1.37 netmask 0xfffffe00 broadcast 192.168.1.255
  # <b>ifconfig xl0 media 100baseTX mediaopt full-duplex</b>
  # <b>ifconfig xl0</b>
  xl0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
          lladdr 00:08:74:2c:df:9c
          groups: egress
          media: Ethernet 100baseTX full-duplex
          status: active
          inet6 fe80::208:74ff:fe2c:df9c%xl0 prefixlen 64 scopeid 0x1
          inet 192.168.1.37 netmask 0xfffffe00 broadcast 192.168.1.255
  # <b>exit</b>
<i>...setup resumes...</i>
</pre></td></tr></table>

<p>
<a href="#backMoreNetwork">(туда, где мы, возможно, были)</a>

<p>
<a name="MoreTimeZone"></a>
<h3>4.6.2 - Настройка часового пояса</h3>
Время в UNIX - не простая вещь (или, другими словами, время в UNIX 
<i>очень</i> простая вещь, но человеческое время представляет собой
политически-управляемый беспорядок).
Файлы часового пояса помогают системе преобразовывать UNIX время 
(количесво секунд после полуночи 01 января 1970 года в GMT) в человеческое 
время, принимая во внимание часовые пояса, переход на летнее время (DST),
изменение правил (DST) и т.п.
Они также включат в себя историю изменений.

<p>
Множественные файлы описания часового пояса иногда дают одинаковое
<i>текущее</i> время, однако, могут иметь различную историю.
Например, EST5EDT и US/Michigan сейчас используют одинаковое время,
но в 1975 году правила были разными. Таким образом, если выполняются 
какие-либо действия с датами и временем, вы должны будете
позаботиться об этих различиях.
Вы должны использовать наиболее конкретный и точный файл часового пояса,  
доступный для вашего региона, а не тот, который дает только точное время в
данный момент.

<p>
Если вы сомневаетесь, программа установки OpenBSD поможет вам найти 
подходящий файл часового пояса.
Просто введите "<tt>?</tt>" в каждой строке и программа установки
покажет вам возможные варианты.
Если первый уровень ответов не подходит, выберите страну и посмотрите варианты:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  What timezone are you in? ('?' for list) [right/EST5EDT] ?
  Africa/      Chile/       GB-Eire      Israel       NZ-CHAT      UCT
  America/     Cuba         GMT          Jamaica      Navajo       US/
  Antarctica/  EET          GMT+0        Japan        PRC          UTC
  Arctic/      EST          GMT-0        Kwajalein    PST8PDT      Universal
  Asia/        EST5EDT      GMT0         Libya        Pacific/     W-SU
  Atlantic/    Egypt        Greenwich    MET          Poland       WET
  Australia/   Eire         HST          MST          Portugal     Zulu
  Brazil/      Etc/         Hongkong     MST7MDT      ROC          posix/
  CET          Europe/      Iceland      Mexico/      ROK          posixrules
  CST6CDT      Factory      Indian/      Mideast/     Singapore    right/
  Canada/      GB           Iran         NZ           Turkey
  What timezone are you in? ('?' for list) [right/EST5EDT] <b>US</b>
  What sub-timezone of 'US' are you in? ('?' for list) ?
  Alaska          Central         Hawaii          Mountain        Samoa
  Aleutian        East-Indiana    Indiana-Starke  Pacific
  Arizona         Eastern         Michigan        Pacific-New
  What sub-timezone of 'US' are you in? ('?' for list) <b>Michigan</b>
</pre></td></tr></table>

<p>
Мы сейчас установили время "US/Michigan". Это создаст символическую ссылку 
в <tt>/etc</tt>, указывающую на соответствующий файл временной зоны
в <tt>/usr/share/zoneinfo</tt>, примерно так:

<blockquote><pre>
  /etc/localtime -> /usr/share/zoneinfo/US/Michigan
</pre></blockquote>

Обратите внимание на каталог "<tt>right/</tt>". Он включает в себя
вторую часть настроек, но иначе дублирует стандартный выбор временной зоны.
Подробнее <a href="faq8.html#NTPerror">здесь</a>.

<p>
<a href="#backMoreTimeZone">(туда, где мы, возможно, были)</a>

<p>
<a name="Morefdisk"></a>
<h3>4.6.3 - Пользовательская разметка c fdisk(8)</h3>

Примечание: несмотря на то, что установщик OpenBSD использует
fdisk на многих платформах, пользователям только
<a href="../../i386.html">i386</a> и <a href="../../amd64.html">amd64</a>
архитектур, возможно, придется столкнуться к причудами его работы.
По этой причине этот раздел ориентирован на i386 and amd64.

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8">
fdisk(8)</a> используется для работы с разделами OpenBSD на вашем жестком
диске. Это помогает отличать раздел OpenBSD от разделов, используемых
другими ОС.

<p>
Если на вашем жестком диске есть раздел, который вы хотите оставить, 
НЕ выбирайте "(W)hole disk".
Да, в этом случае вам придется редактировать таблицу разделов при помощи 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8">
fdisk(8)</a>. Дополнительную информацию об использовании fdisk(8) можно
найти <a href="faq14.html#fdisk">здесь</a>.

<b>Перед началом работы с системой, содержащей данные, которые
вы не хотите потерять, убедитесь, что имеете резервную копию.</b>
В процессе создании таблицы разделов очень легко уничтожить важные данные,
поэтому убедитесь, что (при необходимости) вы готовы к их восстановлению.

<p>
Если вы устанавливаете OpenBSD на машину с другими ОС, вам, перед
установкой, понадобится выделить место на диске.
Обычно, это удаление или уменьшение размера уже существующих разделов.
Программа <a href="http://gparted.sourceforge.net/">gparted</a> может
оказаться полезной для работы с разделами многих популярных ОС, давая
возможность установить OpenBSD на освободившееся место.

<p>
В данном примере мы будем считать, что начинаем с пустого 40 Гб диска и
хотим создать мультизагрузочную систему, оставив 5 Гб вначале диска
для Windows, а остальное отдаем OpenBSD.
Обратите внимание, что пустой диск должен иметь правильный загрузочный
сектор MBR и подпись, которые, в свою очередь, должны быть записанны на
диск прежде, чем с него что-то будет загружено.

<p>
Этот процесс точно такой же, как для работы с существующим разделом.
Необходимо только пропустить этап создания раздела для Windows и
заняться установкой загрузочного сектора MBR.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available disks are: wd0.
  Which one is the root disk? (or 'done') [wd0] <b><i>Enter</i></b>
  MBR has invalid signature; not showing it.
</pre></td></tr></table>

<p>
Если на диске обнаружена верная MBR, то будет показана существующая
таблица разделов.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Use (W)hole disk or (E)dit the MBR? [whole] <b>e</b>

  You will now create a single MBR partition to contain your OpenBSD data. This
  partition must have an id of 'A6'; must *NOT* overlap other partitions; and
  must be marked as the only active partition.  Inside the fdisk command, the
  'manual' command describes all the fdisk commands in detail.

  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
Enter 'help' for information
fdisk: 1>
</pre></td></tr></table>

<p>
Прежде всего, обратите внимание на командную строку fdisk.
Цифра "1" указывает на первый уровень таблицы разделов, если бы вы 
редактировали расширенный раздел, это была бы цифра 2 (или больше).
Расширенные разделы представляют собой разделы, включающие в себя
свои подразделы, что позволило обойти ограничение в четыре раздела  IBM AT.
Здесь расширенные разделы рассматриваться не будут.

<p>
Сначала мы должны создать раздел "0" - раздел Windows 5 Гб (используя
NTFS)  и раздел "1" на оставшемся месте диска для OpenBSD.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk: 1> <b>e 0</b>
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help)
</pre></td></tr></table>

<p>
Так как мы не знаем какой ID раздела соответствует NTFS, можно
ввести "?" для просмотра списка поддерживаемых ФС.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) ?
  Choose from the following Partition id values:
  00 unused         20 Willowsoft     66 NetWare 386    A9 NetBSD
  01 DOS FAT-12     24 NEC DOS        67 Novell         AB MacOS X boot
  02 XENIX /        27 Win Recovery   68 Novell         AF MacOS X HFS+
  03 XENIX /usr     38 Theos          69 Novell         B7 BSDI filesy*
  04 DOS FAT-16     39 Plan 9         70 DiskSecure     B8 BSDI swap
  05 Extended DOS   40 VENIX 286      75 PCIX           BF Solaris
  06 DOS > 32MB     41 Lin/Minux DR   80 Minix (old)    C0 CTOS
  07 NTFS           42 LinuxSwap DR   81 Minix (new)    C1 DRDOSs FAT12
  08 AIX fs         43 Linux DR       82 Linux swap     C4 DRDOSs < 32M
  09 AIX/Coherent   4D QNX 4.2 Pri    83 Linux files*   C6 DRDOSs >=32M
  0A OS/2 Bootmgr   4E QNX 4.2 Sec    84 OS/2 hidden    C7 HPFS Disbled
  0B Win95 FAT-32   4F QNX 4.2 Ter    85 Linux ext.     DB CPM/C.DOS/C*
  0C Win95 FAT32L   50 DM             86 NT FAT VS      DE Dell Maint
  0E DOS FAT-16     51 DM             87 NTFS VS        E1 SpeedStor
  0F Extended LBA   52 CP/M or SysV   8E Linux LVM      E3 SpeedStor
  10 OPUS           53 DM             93 Amoeba FS      E4 SpeedStor
  11 OS/2 hidden    54 Ontrack        94 Amoeba BBT     EB BeOS/i386
  12 Compaq Diag.   55 EZ-Drive       99 Mylex          EE EFI GPT
  14 OS/2 hidden    56 Golden Bow     9F BSDI           EF EFI Sys
  16 OS/2 hidden    5C Priam          A0 NotebookSave   F1 SpeedStor
  17 OS/2 hidden    61 SpeedStor      A5 FreeBSD        F2 DOS 3.3+ Sec
  18 AST swap       63 ISC, HURD, *   A6 OpenBSD        F4 SpeedStor
  19 Willowtech     64 NetWare 2.xx   A7 NEXTSTEP       FF Xenix BBT
  1C ThinkPad Rec   65 NetWare 3.xx   A8 MacOS X
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>07</b>
</pre></td></tr></table>

<p>
Сейчас мы определим значения начала и завершения раздела:
<p>

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you wish to edit in CHS mode? [n]
</pre></td></tr></table>

<p>
Режим CHS позволяет указывать дисковое пространство в формате: цилиндр
- головка - сектор (CHS).
Имейте в виду, что для современных жестких дисков CHS номера полностью 
фиктивны; всего три номера, которые транслируются  в секторы на диске, 
будут переведены в физическую геометрию ваших дисков (которая, вероятно,
изменяется по диску в любом случае).

<p>
Если вы ответили здесь "y", вам будет предложено указать начало и конец 
цилиндра, головки и сектора. 
Если вы ответите "no", вам будет предложено указать начало сектора и размер.
Редактирование CHS часто бывает проще при работе вблизи существующих 
разделов, т.к. указать начальный сектор и размер проще, если вы
хотите быстро создать раздел заданного размера.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  offset: [0] <b>64</b>
</pre></td></tr></table>

<a name="trackoffset"></a>
<p>
Стоит сказать, что fdisk оставляет немного места перед первым разделом. 
На современных машинах точный размер не имеет значения, OpenBSD 
использует по умолчанию  64 сектора. Этот отступ создается по соображениям
производительности.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  size: [0] <b>5g</b>
  Rounding to nearest cylinder: 10490382
</pre></td></tr></table>

<p>
Значением "Size" может быть количество секторов (по 512 байт каждый) 
или желаемый объем со следующими обозначениями "k", "m" или "g".
При редактировании с использованием смещения и размера, fdisk будет 
округлять разделы так,  что бы они заканчивались на границе цилиндра.

<p>
Теперь, давайте посмотрим на наш новый раздел:
<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> p
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
Обратите внимание, что командная строка теперь включает в себя "*".
Это означает, что есть несохраненные изменения.

<p>
Мы выделили место для нашего будущего раздела Windows. 
Обратите внимание, что этот раздел пока не создан. Мы просто зарезервировали
место на диске (раздел не отформатирован, файловая система не создана).
Дальнейшие операции над этим  разделом вы можете проделать во время 
установки самой Windows.

<p>
Сейчас мы создадим раздел OpenBSD. 
В этом случае, идентификатор раздела будет "A6".

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> e 1
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) a6
  Do you wish to edit in CHS mode? [n] <b><i>Enter</i></b>
  offset: [0]
</pre></td></tr></table>

<p>
Оп-па... 
Что с нашим смещением?  Все просто - смещение предыдущего раздела 
плюс размер раздела, в данном случае, 63 +10490382 = 10490445.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  offset: [0] <b>10490445</b>
  size: [0] <b>*</b>
  fdisk:*1>
</pre></td></tr></table>

<p>
Обратите внимание, что здесь мы ввели "*", как размер, что означает 
"остальная часть диска". Опять же, мы могли бы ввести размер в секторах, 
"m" или "g", если мы захотели оставить свободное место для чего-то ещё.

<p>
Теперь мы посмотрим на нашу таблицу разделов:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
   1: A6    653   0   1 -   4998   5  63 [    10490445:    69802803 ] OpenBSD
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
<b>МЫ ЕЩЕ НЕ ЗАКОНЧИЛИ!</b><br>
Этот диск все еще не загрузочный! 
Поскольку это был новый диск,
<a href="faq14.html#Boot386">MBR</a> диска была совершенно пустой. 
Сообщение: "Signature: 0x0" показывает, что отсутствует
действительная  подпись (0xAA55), а это значит, что отсутствует действительный
код загрузки. Конечно, у вас могла бы быть действительная подпись без 
корректного загрузочного кода при случайном невезении или повреждении 
существующего загрузочного кода, но наличие недействительной подписи 
указывает на то, что отсутствует загрузочный код, и, таким образом, мы сейчас 
его установим при помощи команды "update":

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>update</b>
  Machine code updated.
  fdisk:*1>
</pre></td></tr></table>

<p>
Мы также должны установить "flag" раздела как "active", 
для того, чтобы загрузочная ROM знала из какого раздела грузиться:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>f 1</b>
  Partition 1 marked active.
</pre></td></tr></table>

<p>
Теперь давайте посмотрим, что у нас в итоге получилось:

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
  *1: A6    653   0   1 -   4998   5  63 [    10490445:    69802803 ] OpenBSD
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
Вот контрольный список того, что вы должны проверить перед выходом из fdisk(8):

<ul>
<li>Действительна ли подпись?
<li>Не перекрываются ли разделы?
<li>ID раздела OpenBSD "A6"?
<li>Тот ли раздел (скорее всего, раздел OpenBSD) помечен как активный?
</ul>

<p>
<a href="#BackMorefdisk">(туда, где мы, возможно, были)</a>

<p>
<a name="Moredisklabel"></a>
<h3>4.6.4 - Пользовательская разметка c disklabel</h3>

Для разметки OpenBSD раздела, созданного с помощью fdisk(8), 
мы будем использовать 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">
disklabel(8)</a>.
Метки (labels) OpenBSD представляют собой разделы файловой системы, каждому из 
которых присваивается одна из шестнадцати букв, начиная с "а" и заканчивая "р".
Раздел "а" на загрузочном диске является корневым разделом, "b" по 
умолчанию является разделом подкачки. "c" на всех дисках представляет 
собой раздел "всего диска", он используется программами, такими как fdisk(8)
и disklabel(8), которые должны иметь прямой доступ к физическому диску. 
Раздел "c" создается автоматически и не должен удаляться или изменяться. 
Остальные буквы доступны для создания необходимых точек монтирования.
Вы можете пропускать буквы, или использовать их в любом порядке. 
Вы также можете оставить место на диске для других разделов, 
а также отформатировать их позже, или, при помощи 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=growfs&amp;sektion=8">
growfs(8)</a>, увеличить существующие разделы за счет свободного места.

<p>
Все разделы, которые включают FFS, должны находиться в пределах
OpenBSD fdisk(8) раздела, однако,
<a href="faq14.html#foreignfs">не-OpenBSD</a> разделы могут 
(и обычно должны) быть вне этого раздела.

<p>
Более подробную информацию об использовании disklabel можно найти
<a href="faq14.html#disklabel">здесь</a>.

<p>
Более подробную информацию о создании разделов, а также несколько
советов касательно их размеров можно найти <a href="#Partitioning">ниже</a>.

<p>
Программа установки OpenBSD разметит диск автоматически
в удобной конфигурации "общего назначения", основанной на размере вашего 
диска. Если ваш диск достаточно большой, неиспользуемое пространство будет 
выделено под раздел <tt>/home</tt>. Иногда это помогает и бывает весьма
полезно, однако это не может удовлетворить потребности всех пользователей.

<p>
Предположим, что мы создаем web-сервер для использования нашими друзьями.
У нас есть подключенная к Интернету машина, с 40Гб диском, при этом мы
будем использовать, в основном, OpenBSD (с тем же 5Гб разделом Windows, 
как в примере выше). Почему? Возможно, эта система имеет RAID-контроллер,  
поддерживаемый  OpenBSD, но управляемый только из Windows. 
Однако, скорее всего, потому, что редактор FAQ не испытывает симпатии 
к поддержке многих различных систем.

<p>
Страницы web-сервера в OpenBSD будут находиться  в 
<tt>/var/www</tt>, и, совсем немного, в <tt>/home</tt>. 
Это указывает на необходимость сделать определенные изменения в схеме 
по умолчанию. В целях обсуждения, мы также считаем, что нам не понадобится
пересобирать операционную систему из исходников на этой машине 
(мы сделаем это в другом месте). Мы не будем запускать X, однако,
учитывая, что некоторые web-приложения <a href="#FilesNeededX">требуют
установленный X</a>, мы его установим.  Наша машина не слишком мощная
и не может иметь более 1Гб оперативной памяти, но вряд ли нашему
приложению понадобится больше.

<p>
Таким образом, после некоторого размышления, наш план разметки диска 
состоит в следующем: 
<ul>
<li><tt>/ - root</tt>: 100мб.  Это будет "a".
<li><tt>swap</tt>: 1Гб (так у нас всегда будет достаточно места для 
дампа),  это будет раздел "b"
<li><tt>/usr</tt>: 2Гб, раздел "d".
<li><tt>/tmp</tt>: 100 Мб (мы не ожидаем активного его использования), 
раздел "e".
<li><tt>/usr/local</tt>: 2Гб, раздел "f".
<li><tt>/usr/X11R6</tt>: 1Гб, раздел "g".
<li><tt>/home</tt>: 1Гб, раздел"h".
<li><tt>/var</tt>: 1Гб (здесь находится очень много системных 
log-файлов), раздел "j".
<li><tt>/var/www</tt>: остальное место на диске, раздел "k".
</ul>

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  The auto-allocated layout for wd0 is:
  #                size           offset  fstype [fsize bsize  cpg]
    a:          1024.0M         10490445  4.2BSD   2048 16384    1 # /
    b:           252.1M         12587597    swap
    c:         39205.7M                0  unused
    d:          2319.3M         13103933  4.2BSD   2048 16384    1 # /tmp
    e:          3653.9M         17853877  4.2BSD   2048 16384    1 # /var
    f:          1149.8M         25337016  4.2BSD   2048 16384    1 # /usr
    g:          1024.0M         27691862  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          3422.6M         29789014  4.2BSD   2048 16384    1 # /usr/local
    i:          5122.3M               63    NTFS
    j:          1848.7M         36798433  4.2BSD   2048 16384    1 # /usr/src
    k:          1848.7M         40584654  4.2BSD   2048 16384    1 # /usr/obj
    l:         17540.2M         44370875  4.2BSD   2048 16384    1 # /home
  Use (A)uto layout, (E)dit auto layout, or create (C)ustom layout? [a] <b>c</b>
</pre></td></tr></table>

<p>
Если бы мы хотели сделать только незначительные изменения, мы бы, 
вероятно, решили "Редактировать" предложенную автоматическую разбивку, 
а не начинать с чистого листа, но мы собираемся выбрать сложный вариант.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now create an OpenBSD disklabel inside the OpenBSD MBR
  partition. The disklabel defines how OpenBSD splits up the MBR partition
  into OpenBSD partitions in which filesystems and swap space are created.
  You must provide each filesystem's mountpoint in this program.

  The offsets used in the disklabel are ABSOLUTE, i.e. relative to the
  start of the disk, NOT the start of the OpenBSD MBR partition.

  Label editor (enter '?' for help at any prompt)
  > <b>p</b>
  OpenBSD area: 10490445-80293248; size: 69802803; free: 69802803
  #                size           offset  fstype [fsize bsize  cpg]
    c:         80293248                0  unused
    i:         10490382               63    NTFS
  >
</pre></td></tr></table>

<p>
Обратите внимание, что уже есть два существующих раздела, -- раздел "с", 
который всегда существует и создан автоматически, но disklabel(8) также 
сообщает, о существующем разделе NTFS и назначенной ему метке раздела, 
таким образом, этот раздел потенциально может быть доступен из OpenBSD 
(обратите внимание, в настоящее время поддержка NTFS является
экспериментальной и требует собственного ядра, но поддержка FAT/FAT32 
реализована довольно хорошо).

<p>
Теперь мы создадим наши разделы. 
Мы начнем с нашего корневого раздела "a":

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a a</b>
  offset: [10490445] <b><i>Enter</i></b>
  size: [69802803] <b>100m</b>
  Rounding to cylinder: 208845
  FS type: [4.2BSD]  <b><i>Enter</i></b>
  mount point: [none] <b>/</b>
  >
</pre></td></tr></table>

<p>
Обратите внимание, что по умолчанию disklabel использует первый 
доступный сектор OpenBSD на диске, это, как раз то, что мы хотим. 
Кроме того, по умолчанию в размер раздела включается все доступное 
пространство, что нас НЕ устраивает.  
Здесь мы использовали необходимый нам размер, который может быть 
указан в секторах, "M" или "G".

<p>
Вы, скорее всего, захотите использовать файловую систему по умолчанию 
"4.2BSD" для раздела FFS (Fast File System) или FFS2, хотя могут быть 
использованы другие полезные типы, включая "swap" и "RAID".

<p>
Наконец, указывается точка монтирования. 
Наш раздел "а" является корневым разделом по определению.

<p>
Теперь мы создаем swap, который является нашим разделом «b» 
(опять же,  установлено, что раздел "b" на загрузочном диске - это swap):

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a b</b>
  offset: [10699290] <b><i>Enter</i></b>
  size: [69593958] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [swap] <b><i>Enter</i></b>
  >
</pre></td></tr></table>

<p>
Итак, disklabel правильно рассчитал наш начальный сектор, и предложил нам 
использовать размер "всего оставшегося пространства", которое мы снова 
установили сами.
Поскольку это раздел «b», disklabel предположил, что он должен 
использоваться для подкачки, и, когда мы это подтвердили, вопрос 
о точке монтирования не задавался. 

<p>
Теперь мы готовы создать остальные разделы.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a d</b>
  offset: [12803805] <b><i>Enter</i></b>
  size: [67489443] <b>2g</b>
  Rounding to cylinder: 4209030
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr</b>
  > <b>a e</b>
  offset: [17012835] <b><i>Enter</i></b>
  size: [63280413] <b>100m</b>
  Rounding to cylinder: 208845
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/tmp</b>
  > <b>a f</b>
  offset: [17221680] <b><i>Enter</i></b>
  size: [63071568] <b>2g</b>
  Rounding to cylinder: 4209030
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr/local</b>
  > <b>a g</b>
  offset: [21430710] <b><i>Enter</i></b>
  size: [58862538] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr/X11R6</b>
  > <b>a h</b>
  offset: [23535225] <b><i>Enter</i></b>
  size: [56758023] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/home</b>
  > <b>a j</b>
  offset: [25639740] <b><i>Enter</i></b>
  size: [54653508] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var</b>
  > <b>a k</b>
  offset: [27744255] <b><i>Enter</i></b>
  size: [52548993] <b><i>Enter</i></b>
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var/www</b>
  >
</pre></td></tr></table>

<p>
Отметим, что на разделе <tt>/var/www</tt> ("k"), мы просто взяли 
значение по умолчанию, чтобы использовать все оставшееся свободное 
место на диске. 
С современными чудовищно огромными дисками, обычно это плохая идея. 
При наличии опыта, вы никогда не будете использовать его целиком, 
не выделяйте его и сохраните его для использования в будущем.

<p>
Теперь, давайте посмотрим на наши результаты, используя команды "р" и "p m":
<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>p</b>
  OpenBSD area: 10490445-80293248; size: 69802803; free: 0
  #                size           offset  fstype [fsize bsize  cpg]
    a:           208845         10490445  4.2BSD   2048 16384    1 # /
    b:          2104515         10699290    swap
    c:         80293248                0  unused
    d:          4209030         12803805  4.2BSD   2048 16384    1 # /usr
    e:           208845         17012835  4.2BSD   2048 16384    1 # /tmp
    f:          4209030         17221680  4.2BSD   2048 16384    1 # /usr/local
    g:          2104515         21430710  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          2104515         23535225  4.2BSD   2048 16384    1 # /home
    i:         10490382               63    NTFS
    j:          2104515         25639740  4.2BSD   2048 16384    1 # /var
    k:         52548993         27744255  4.2BSD   2048 16384    1 # /var/www
  > <b>p m</b>
  OpenBSD area: 10490445-80293248; size: 34083.4M; free: 0.0M
    #                size           offset  fstype [fsize bsize  cpg]
    a:           102.0M         10490445  4.2BSD   2048 16384    1 # /
    b:          1027.6M         10699290    swap
    c:         39205.7M                0  unused
    d:          2055.2M         12803805  4.2BSD   2048 16384    1 # /usr
    e:           102.0M         17012835  4.2BSD   2048 16384    1 # /tmp
    f:          2055.2M         17221680  4.2BSD   2048 16384    1 # /usr/local
    g:          1027.6M         21430710  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          1027.6M         23535225  4.2BSD   2048 16384    1 # /home
    i:          5122.3M               63    NTFS
    j:          1027.6M         25639740  4.2BSD   2048 16384    1 # /var
    k:         25658.7M         27744255  4.2BSD   2048 16384    1 # /var/www
  >
</pre></td></tr></table>

<p>
Как и с fdisk, ваши подразделы раздела OpenBSD не должны
перекрываться (кроме раздела 'c', который перекрывает все разделы). 

<p>
Запишите ваши изменения и выйдите из disklabel:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>w</b>
  > <b>q</b>
  No label changes.
  newfs: reduced number of fragments per cylinder group from 13048 to 12992 to
  enlarge last cylinder group
  /dev/rwd0a: 102.0MB in 208844 sectors of 512 bytes
  5 cylinder groups of 25.38MB, 1624 blocks, 3328 inodes each
  /dev/rwd0h: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  newfs: reduced number of fragments per cylinder group from 13048 to 12992 to
  enlarge last cylinder group
  /dev/rwd0e: 102.0MB in 208844 sectors of 512 bytes
  5 cylinder groups of 25.38MB, 1624 blocks, 3328 inodes each
  /dev/rwd0d: 2055.2MB in 4209028 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0g: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0f: 2055.2MB in 4209028 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0j: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0k: 25658.7MB in 52548992 sectors of 512 bytes
  127 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local)
  /dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0e on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0d on /mnt/usr type ffs (rw, asynchronous, local, nodev)
  /dev/wd0g on /mnt/usr/X11R6 type ffs (rw, asynchronous, local, nodev)
  /dev/wd0f on /mnt/usr/local type ffs (rw, asynchronous, local, nodev)
  /dev/wd0j on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0k on /mnt/var/www type ffs (rw, asynchronous, local, nodev, nosuid)

  Let's install the sets!
...
</pre></td></tr></table>

<p>
<a href="#BackMoredisklabel">(туда, где мы, возможно, были)</a>

<p>
<a name= "FilesNeeded"></a>
<h2>4.7 - Какие файлы нужны для установки?</h2>
<!-- XXXrelease -->
<p>
Полная установка OpenBSD разбита на некоторое количество
<i>компонентов</i>. Не каждое приложение требует наличия
всех компонентов. Вот краткое их описание:

<p>
<ul>
  <li><b><i>bsd</i></b>          - Ядро. <b>Обязательно</b>
  <li><b><i>bsd.mp</i></b> - Мульти-процессорное (SMP) ядро (только для некоторых 
        платформ).
  <li><b><i>bsd.rd</i></b> - <a href="#bsd.rd">ядро RAM диска</a>.
  <li><b><i>base54.tgz</i></b>   - содержит базовую систему OpenBSD. 
        <b>Обязятельно</b>
  <li><b><i>etc54.tgz</i></b>    - Содержит все файлы, находящиеся в /etc. 
        <b>Обязятельно</b>
  <li><b><i>comp54.tgz</i></b>    - Содержит компилятор и его инструменты, 
        заголовочные файлы и библиотеки.
  <li><b><i>man54.tgz</i></b>    - Содержит справочные страницы.
  <li><b><i>game54.tgz</i></b>   - Содержит игры для OpenBSD.
  <li><b><i>xbase54.tgz</i></b>  - Содержит базовые библиотеки и утилиты для X11.
  <li><b><i>xetc54.tgz</i></b>   - Содержит конфигурационные файлы из /etc/X11 
        и /etc/fonts.
  <li><b><i>xfont54.tgz</i></b>  - Содержит сервер шрифтов X11 и шрифты.
  <li><b><i>xserv54.tgz</i></b>  - Содержит X-серверы X11.
  <li><b><i>xshare54.tgz</i></b> - Содержит страницы руководств, 
        региональные настройки, включаемые файлы и т.д. для X.
</ul>
Компоненты <b>etc54.tgz</b> и <b>xetc54.tgz</b> не устанавливаются
при обновлении, а только при полной установке, так что любые ваши
настройки, внесенные вами когда-либо, потеряны не будут. Вам нужно
будет обновлять каталоги <tt>/etc</tt>, <tt>/dev</tt>
и <tt>/var</tt> вручную.

<a name="FilesNeededX"></a>
<h3>Почему я должен устанавливать X для моего не-графического приложения?</h3>

Даже если вы не планируете запускать X, некоторые <a href="faq15.html">
пакеты</a> сторонних разработчиков требуют наличия библиотек или других
X-утилит в вашей системе. Обычно достаточно только xbase54.tgz, остальные
X не всегда нужны. Многие пользователи не хотят устанавливать X без
веских оснований для этого:

<ul>
<li>Сама по себе установка X не вызывает запуска каких-либо программ в системе.
<li>Сама по себе установка X в системе не изменяет риск внешней безопасности.
<li>Если кто-то уже находится в вашей системе, он, скорее всего, установит все, 
что угодно, так что наличие или отсутствие X заметно не изменит ситуацию.
<li>Только часть X необходима для вашего приложения.
<li>Дисковое пространство, необходимое для X, является относительно скромным 
для современного оборудования. 
</ul>

Иногда люди тратят много времени и усилий, пытаясь извлечь из xbase54.tgz 
только файлы, необходимые для установки их приложения. 
Это не только бессмысленно, но и усилия, которые прилагаются для этого,
повторяются при каждом цикле обновления, что приводит к невозможности корректно 
обновить вашу систему, создавая РЕАЛЬНЫЕ проблемы безопасности.

<p>
Если вам нужен X, просто установите его. Это не повредит больше, чем нужное 
вам какое-либо приложение.

<a name="FilesNeededComp"></a>
<h3>Я не хочу устанавливать компиляторы</h3>
Ладно, но, пожалуйста, не говорите себе, что это "из соображений безопасности". 
Если к тому времени кто-то сможет достаточно глубоко проникнуть в вашу 
систему, наличие или отсутствие компилятора ни на что не повлияет, 
т.к. взломщики могут установить его сами. 
Кроме того, набор файлов compXX.tgz достаточно большой и содержит много файлов, 
поэтому он может занять некоторое время для установки и обновления, 
что на медленных или малых системах может иметь значение.

<p>
Если вы решили не устанавливать компилятор, возможно, вам понадобится другая 
система для сборки обновлений программного обеспечения. Существует гораздо
больше систем, которые были скомпрометированы из-за неправильного 
обслуживания, чем из-за установки компилятора.

<p>
<a name="Partitioning"></a>
<h2>4.8 - Разметка диска</h2>
<!-- XXXrelease -->

<p>
Очевидно, что ответ на этот вопрос в значительной степини зависит от того, 
как вы планируете использовать систему. 
OpenBSD может быть установлена на диск всего в 512 Мб, но установка на таком 
малом устройстве дело для продвинутых пользователей. 
До тех пор, пока у вас не появится некоторый опыт, рекомендуется использовать диск 
объемом от 8Гб и больше.

<p>
В отличие от многих других операционных систем, OpenBSD рекомендует пользователям 
вместо того, чтобы использовать только один или два больших раздела,
разбивать диск на несколько разделов. 
Есть ряд причин, для использования такой разбивки: 

<ul>
<li><b>Безопасность:</b> Вы можете отметить некоторые файловые системы, как 
  'nosuid', 'nodev', 'noexec', 'readonly' и т.д. Если вы используете разбивку 
  по умолчанию, это будет сделано за вас в процессе установки. 
<li><b>Стабильность:</b> Пользователь или сбойная программа, если они имеют 
  право на запись в файловую систему, могут заполнить ее мусором. 
  На ваши важные программы, которые, как мы надеемся, работают в другой файловой 
  системе, это никак не повлияет.
<li><b>Скорость:</b> Файловая система, на которую часто осуществляются 
  процедуры записи, будет фрагментирована. (К счастью, файловая система FFS, 
  которую использует OpenBSD, не склонна к серьезной фрагментации.)
<li><b>Целостность:</b> Если одна из файловых систем по некоторым причинам 
  повреждена, то ваши другие файловые системы будут, скорее всего, в порядке.
<li><b>Размер:</b> Многие машины имеют ограничения на область диска, 
  откуда загрузочный ROM может загрузить ядро. В некоторых случаях это 
  ограничение может быть очень малым (504Mб для машин, старше 486), 
  в других случаях, ограничение гораздо больше (например, 2Гб, 8Гб или 128Гб 
  на i386 системах). Так как ядро может закончиться в любом месте внутри 
  корневого раздела, весь корневой раздел должен быть в этой области. 
  Для получения дополнительной информации см. 
  <a href="faq14.html#LargeDrive">этот раздел</a>. Хорошим ориентиром может быть 
  расположение вашего корневого раздела целиком ниже 2Гб, если вы не знаете 
  вашу платформу (и конкретно машину) это значение может быть больше (или меньше).
<li><b>Только для чтения:</b> Вы можете монтировать разделы, которые никогда 
  или очень редко используются для записи, в основном как "только для чтения", 
  что устранит необходимость в fsck(8) после аварии или сбоя питания и может 
  помочь предотвратить непреднамеренное изменение данных.
<li><b>fsck(8):</b> Очень большие разделы требуют больше оперативной памяти 
  для выполнения fsck(8) и на системах с небольшим объемом памяти, вам придется, 
  в конечном итоге, использовать swap, в следствие очень долгого выполнения fsck.
</ul>

При наличии достаточного места на диске, программа установки OpenBSD 
по умолчанию предложит создать следующие разделы:

<ul>
<li><b>/ - root:</b>
В дополнение к смонтированным другим файловым системам, корневая файловая система 
содержит все файлы, необходимые для загрузки OpenBSD. Они включают в себя ядро, 
а также основные базовые утилиты в <tt>/sbin</tt> и <tt>/bin</tt>, файлы 
конфигурации в <tt>/etc</tt> и каталог устройств <tt>/dev</tt>, которые используются 
при запуске системы. Корневая файловая система может быть небольшой в 60Мб, 
хотя при размере от 200Мб до 500Мб будет легче для машины в течение многих циклов 
обновления. Раздел 'a' загрузочного диска автоматически становится вашим корневым 
разделом. 
НЕКОТОРЫЕ платформы, для возможности загрузки с него, также, накладывают 
ограничения на физическое размещение этого раздела на диске 
(то есть, раздел должен быть в начале диска).

<li><b>Swap:</b>
Этот раздел, также, используется для хранения дампов после сбоев системы, 
поэтому пространство swap (если установлен для всех) должно быть больше, 
чем самый большой объем оперативной памяти, 
который вы захотите когда-нибудь установить на машину. 
Подробнее об этом читайте в <a href="faq14.html#Swap">FAQ 14, Swap</a>.

<li><b>/tmp:</b>
Это каталог, доступный для записи всем, используется (как следует из названия) 
для временного хранения. 
Большинство систем может хранить здесь очень скромные объемы данных, 50Мб обычно 
во много раз превышает реальные потребности, хотя есть несколько приложений, 
которые могут использовать намного больше. 
В то время, как этот каталог является доступным для записи всем, когда это 
отдельный раздел, OpenBSD по умолчанию монтирует его как nodev и nosuid, 
что минимизирует возможные злоупотребления в вашей системе 
с использованием этого раздела. 
Обратите внимание, что этот каталог очищается при перезагрузке, а файлы, 
которые остались нетронутыми в течение 24 часов, будут удалены ночью.

<li><b>/var:</b>
Этот каталог и точки монтирования, используются для многих вещей, и, 
в зависимости от цели использования, может быть главным кандидатом для разбивки 
на несколько разделов. 
Вот некоторые из вещей, которые здесь расположены (включая дополнительные 
потенциальные точки монтирования):
<ul>
  <li><tt>/var/log</tt>: Системные журналы.
  <li><tt>/var/mail</tt>: Почтовые ящики входящей почты.
  <li><tt>/var/spool</tt>: Исходящая почта (и некоторое другое)
  <li><tt>/var/www</tt>: Здесь в OpenBSD живет
     <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">web сервер</a>.     
  <li><tt>/var/tmp</tt>: Это "постоянный" каталог временных файлов - файлы, 
     помещенные здесь НЕ очищаются при перезагрузке. Например, vi(1) использует 
     этот каталог для временного хранения файлов, так, если ваш компьютер выходит 
     из строя или в результате перезагрузки при редактировании файла, находящиеся 
     здесь файлы, могут использоваться для восстановления сессии редактирования. 
     Файлы остаются здесь в течение 24 часов, однако, будут удалены ночью 
     сценариями очистки 
     <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>.
   <li><tt>/var/crash</tt>: Если система "в панике", она будет пытаться сохранить 
     дамп ядра в раздел подкачки перед перезагрузкой. При перезагрузке, этот 
     дамп будет сохранен в <tt>/var/crash</tt>, так что для <tt>/var</tt> 
     понадобится по меньшей мере столько свободного пространства, 
     сколько система имеет ОЗУ для того, чтобы это работало автоматически.
   </ul>

<li><b>/usr:</b>
Это место, где проживает большая часть OpenBSD. 
Исполняемые файлы программ, библиотеки, документация, справочные страницы и т.д. 
- все это расположено в каталоге <tt>/usr</tt>. 
Файлы в этой точке монтирования относительно неизменны - во многих случаях, 
можно легко смонтировать раздел <tt>/usr</tt> только для чтения ничего 
не изменяя в системе до следующего обновления.

<li><b>/usr/X11R6:</b>
Здесь находится система X Window. 
Двоичные файлы X, файлы шрифтов, библиотеки и т.д. все это расположено здесь. 
Единственная часть X, которая здесь не расположена - это файлы конфигурации.

<li><b>/usr/local:</b>
При установке OpenBSD по умолчанию, эта точка монтирования/каталог полностью пуст. 
Он используется для установленных локально файлов и библиотек локальных приложений.

<li><b>/usr/src:</b>
Этот каталог содержит исходные файлы основной системы, за исключением X и портов. 
Этот каталог пуст по умолчанию, вы должны загрузить в него исходные файлы, 
как описано в <a href="faq5.html#BldGetSrc">FAQ 5</a>.

<li><b>/usr/obj:</b>
Этот каталог заполняется во время процесса сборки объектными и исполняемыми файлами. 
Имея этот каталог, как отдельную точку монтирования, можно просто отформатировать 
его, вместо того, чтобы удалять файл за файлом, что будет значительно быстрее.

<li><b>/home:</b>
В этом месте находятся файлы пользователей. 
Если этот каталог представляет собой отдельный раздел, то можно будет легко 
полностью переустановить систему; просто не форматируя этот раздел при перезагрузке.
</ul>

<p>
Некоторые дополнительные мысли о разбивке диска:
<ul>
 <li>Для вашей первой попытки поэкспериментировать с системой, пока вы еще не 
   знаете сколько места для каждого раздела будет нужно, создание одного большого 
   корневого раздела и свопа может оказаться более простым решением. 
   Делая это, вам придется пожертвовать некоторыми из базовых функций безопасности
   OpenBSD, для которых требуется, чтобы <tt>/, /tmp, /var, /usr</tt> и <tt>/home</tt>
   были отдельными файловыми системами. Тем не менее, вероятно, не следует 
   использовать первую установленную систему OpenBSD в качетве рабочей системы.
 <li>Системы, связанные с Интернет или другой враждебной средой должны иметь 
   в качестве отдельного раздела <tt>/var</tt> (и, возможно, даже <tt>/var/log</tt>)
   для регистрации действий. 
 <li>Использование отдельного раздела для <tt>/home</tt>, также будет хорошим 
   решением. Устанавливаете новую версия ОС? 
   Сотрите и переустановите все остальное, оставьте только нетронутым раздел 
   <tt>/home</tt>. Также, не забудьте сохранить копию файлов конфигурации!
 <li>Использование отдельного раздела для всего, что может накапливать большое 
   количество файлов, которые придется позже удалять, дает возможность 
   переформатировать этот раздел, вместо того, чтобы удалять эти файлы вручную. 
   Обратитесь к <a href="faq5.html#ProbObjPt">FAQ сборка из исходников</a> 
   для просмотра примеров (<tt>/usr/obj</tt>). 
 <li>Если вы захотите по какой-либо причине пересобрать вашу систему из исходников, 
   исходники будут находиться в <tt>/usr/src</tt>. Если вы не сделали отдельный 
   раздел для <tt>/usr/src</tt>, убедитесь, что на <tt>/usr</tt> достаточно 
   свободного места. 
 <li>Часто забываемый факт: вы <b>не</b> должны выделять все место на диске при 
   установке системы! Так как в настоящее время проблематично купить новый 
   диск меньше 100Гб, есть смысл оставить часть диска нераспределенной. 
   Если ваши файлы не помещаются в разделе, вы всегда сможете выделить новый 
   раздел из неиспользуемого пространства, 
   <a href="faq10.html#DupFS">продублировав</a> существующий раздел в новый раздел, 
   затем изменить 
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab</a>,
   чтобы запись в нем указывала на новый раздел, и вот, теперь у вас есть больше 
   пространства в этом разделе. 
 <li>Если вы создадите разделы слишком близко к минимально необходимому размеру, 
   то, вероятно, будете сожалеть об этом позже при обновлении системы. 
 <li>Если вы будете создавать очень большие разделы, имейте в виду, что для 
   выполнения проверки файловой системы 
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</a> 
   требуется около 1Мб оперативной памяти в расчете на гигабайт файловой системы, 
   что на старых и медленных системах может потребовать очень много времени для 
   проверки или даже сделать это не возможным
   (посмотрите также <a href="faq14.html#LargeDrive">этот раздел</a>). 
 <li>Если вы позволите пользователям записывать в <tt>/var/www</tt>
   (т.е. персональные веб-страницы), вы, возможно, захотите сделать его в виде 
   отдельного раздела, можно также для ограничения используемого пользователями 
   пространства использовать <a href="faq10.html#Quotas">квоты</a> и, 
   если пользователи заполнят этот раздел, это никак не помешает другим 
   частям вашей системы. 
 <li>Вы также можете создать раздел <tt>/altroot</tt>, как это описано в 
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>. 
   Это можно использовать для создания ежедневных копий корневого раздела, 
   предоставляя вам дополнительную копию вашего ядра и конфигурационных файлов из 
   <tt>/etc</tt> на случай, если что-то случится с вашим корневым разделом. 
   Очевидно, что раздел <tt>/altroot</tt> должен быть, по крайней мере, больше 
   чем <tt>/</tt>. Если у вас есть второй диск и что-то из ваших данных требует 
   дублирования, вы можете это сделать с помощью такого программного обеспечения 
   как <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&amp;sektion=4">softraid(4)</a>
   или делать периодические копии с помощью 
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>/
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>, 
   этот диск можно сделать загрузочным после удаления основного диска. 
 <li>Компиляция некоторых <a href="faq15.html#Ports">портов</a> из исходников 
   может занимать огромное количество места в разделах <tt>/usr</tt> и <tt>/tmp</tt>. 
   Это еще одна из причин, по которой мы предлагаем использовать 
   <a href="faq15.html#PkgMgmt">предварительно скомпилированные пакеты</a>
   вместо сборки из портов. 
 <li>По крайней мере, некоторые редакторы используют <tt>/var/tmp</tt> 
   как рабочее пространство, и таким образом, этот раздел должен быть больше, 
   чем самый большой редактируемый вами файл. Если вы планируете редактировать 
   файлы 500Мб, ваши разделы <tt>/var</tt> или <tt>/var/tmp</tt> должны быть 
   намного больше, чем вы, возможно, планировали.

</ul>


<p>
<a name= "Multibooting"></a>
<h2>4.9 - Мультизагрузка OpenBSD (amd64, i386)</h2>

Мультизагрузка подразумевает использование на одном компьютере несколько
ОС, а также средства выбора нужной из них при загрузке. Это <i>НЕ</i>
простая задача! Если вы недопонимаете что делаете, вы можете уничтожить
важные данные на компьютере. Новичкам в OpenBSD <i>настоятельно</i>
рекомендуется попрактиковаться в создании желаемой конфигурации на чистом
тестовом диске, не содержащем важных данных, прежде чем приступать к
подготовке и настройке мультизагрузки на рабочей машине. О загрузке
OpenBSD более подробно написано в <a href="faq14.html">FAQ 14</a>.

<p>
Для загрузки OpenBSD предпочтительно использовать один из четырех <i>основных</i>
разделов MBR (то есть, на расширенных разделах это может не работать). 

<p>
Обратите внимание, что в Windows 7 и Vista можно изменить размер своих системных 
разделов: нужно перейти в Панель управления, найти "разбивка", и запустить 
соответствующие системные инструменты. Щелкните правой кнопкой мыши на раздел 
и вы увидите, что можете уменьшить его. Его основным ограничением является то, 
что файл Windows Exchange не может быть перемещен, так что, если вам понадобится 
больше свободного места, вам придется переместить/отключить его. 

<p>
Вот несколько вариантов настройки мультизагрузки:

<h3>Установка активного раздела</h3>
Это, наверное, самый упускаемый из виду способ, но иногда именно он лучше
всего подходит для мультизагрузки. Просто сделайте в текущей ОС активным тот
раздел, с которого хотите загружаться. Практически каждая ОС имеет для этого
встроенные средства; в OpenBSD это <a href="faq14.html#fdisk">fdisk(8)</a>,
похожие по названию программы есть в Windows 9x и DOS и во многих других
системах. Этот способ рекомендуется для систем или ОС с большим временем
выключения или перезагрузки — вы можете сделать установку, начать процесс
перезагрузки, после чего прогуляться, сделать чашечку кофе, и вернуться уже
к полностью загруженной нужной вам ОС — не нужно сидеть и ждать "Волшебного
Момента" появления меню с выбором ОС для загрузки.

<h3>Загрузочная дискета</h3>


Если вы редко пользуетесь OpenBSD (или не хотите, чтобы другие пользователи
компьютера заметили, что что-то изменилось), подумайте об использовании
загрузочной дискеты. Просто возьмите одну из <a href="#MkFlop">стандартных
установочных дискет OpenBSD</a>, и создайте файл <tt>/etc/boot.conf</tt>
(да, вам также придется создать создать на дискете каталог <tt>/etc</tt>)
следующего содержания:

<pre>
     boot hd0a:/bsd
</pre>

для того, чтобы система загружала файл ядра <tt>/bsd</tt> с жесткого диска
0, раздела 'а' OpenBSD. Вы можете также загрузиться и с другого диска, например:
"<tt>boot hd2a:/bsd</tt>" для загрузки с третьего жесткого диска. Для загрузки
OpenBSD вставьте дискету и перезагрузитесь. Для загрузки другой ОС - извлеките
дискету и перегрузитесь (можно, конечно, использовать эту дискету, и для
создания загрузочного CD).

<p>
В этом случае программа 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">
boot(8)</a> загружается с гибкого диска, находит и считывает файл
<tt>/etc/boot.conf</tt>. Команда "<tt>boot hd0a:/bsd</tt>" указывает boot(8)
откуда загружать ядро — в данном случае с первого жесткого диска, согласно
настройкам BIOS. С дискеты загружается только маленький файл (<tt>/boot</tt>)
— сама система, включая ядро, загружается с жесткого диска, так что процесс
загрузки увеличится всего секунд на пять.

<h3>Windows NT/2000/XP NTLDR</h3>

Для настройки мультизагрузки OpenBSD и Windows NT/2000/XP можно использовать
NTLDR, стандартный загрузчик NT. Для мультизагрузки из NT, необходимо будет
скопировать загрузочную запись на раздел OpenBSD (PBR). После запуска
Installboot, вы можете скопировать ее в файл с помощью 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">
dd(1)</a>, следующим образом:

<pre>
	# <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>

Внимание! Это хороший момент напомнить вам о том, что исполнение команд
в командной строке методом перепечатывания, без понимания их смысла, весьма
плохая затея. Эта команда не будет работать сходу на большинстве компьютеров.
Читателю оставляется возможность адаптировать ее к своему компьютеру.

<p>
Теперь загружайте NT и разместите <tt>openbsd.pbr</tt> в корень C:.
Добавьте строку следующего вида в конец файла <tt>C:\BOOT.INI</tt>: 

<pre>
	c:\openbsd.pbr="OpenBSD"
</pre>

<p>
После перезагрузки у вас появится возможность выбора OpenBSD из меню
загрузчика NT. Дополнительную информацию о NTLDR можно найти в 
<a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">
NTLDR Hacking Guide</a>.

<p>
В Windows XP вы можете изменить загрузочную информацию из графической
оболочки; смотрите  
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289022">
XP Boot.ini HOWTO</a>.

<p>

Есть программы, которые сделают все за вас, к примеру, 
<a href="http://www.winimage.com/bootpart.htm">BootPart</a>.
Эту программу можно запустить в NT/2000/XP, а она сама извлечет
OpenBSD PBR, разместит его в разделе NT/2000/XP, и добавит запись в
<tt>C:\BOOT.INI</tt>.

<p>
Внимание! Загрузчик Windows NT/2000/XP может загрузить ОС только с
основного жесткого диска системы. Вам не удастся загрузить с его помощью
OpenBSD, установленную на второй диск.

<h3>Windows Vista</h3>

<p>
Начиная с Vista, Microsoft отказалась от поддержки NTLDR в пользу своего нового, 
используемого для управления загрузкой, Boot Configuration Data (BCD). 
С тех пор <tt>BOOT.INI</tt> больше не доступен для настройки, утилиты 
командной строки, bcdedit заняли его место. 

<p>
После того, как PBR OpenBSD будет скопирован в системный раздел Vista, 
следующие три команды необходимы для выбора и загрузки OpenBSD после 
перезагрузки системы:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386" /application bootsector
The entry {05a763ce-d81b-11db-b3ec-000000000000} was successfully created.

C:\Windows\System32>
</pre></blockquote>

<p>
В данном случае программой возвращен 
GUID <tt>05a763ce-d81b-11dB-b3ec-000000000000</tt> 
и приводится здесь для иллюстрации. Обратите внимание, что GUID отображенный 
при запуске этой команды, нужно будет скопировать в следующие команды. 
Простое копирование  GUID, показанного выше, не сработает. 

<p>
Следующие две команды также обязательны:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<p>Эти команды должны быть запущены в оболочке с правами администратора. 
После того как вы определите расположение cmd.exe, щелкните на нем правой 
кнопкой мыши для выбора "запуск от имени администратора". 

<p>
Обратите внимание на использование абсолютного пути к импортированному файлу PBR. 
Не добавляйте буквенных обозначений дисков, так как предполагается, что файл 
находится в системном разделе. <tt>bcdedit</tt> не будет ругаться на явное указание 
спецификации дисков, однако, менеджер загрузки будет задумываться, утверждая, 
что не не может разрешить указанный путь. 

<p>
После перезагрузки, Vista будет первой в списке менеджера загрузки затем 
следует OpenBSD. Согласно вашего выбора, будет загружена соответствующая 
операционная система. 

<p>
Если ничего не происходит, посмотрите в Панели управления информацию о загрузке. 
Скорее всего, загрузка Windows установлена ​​без задержки, так что вы не видите 
меню загрузки. Вы также можете установить загрузку OpenBSD по умолчанию. 

<p>
Для получения дополнительной информации обратитесь к функции помощи <tt>bcdedit</tt>, 
используя следующую команду:

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /?
</pre></blockquote>

<p>
или путем поиска документации Microsoft на веб-сайте. 
Хорошее описание можно найти в этой TechNet статье 
<a href="http://technet.microsoft.com/en-us/library/cc721886%28WS.10%29.aspx">
Часто задаваемые вопросы</a>. 

<p>
Для тех, кому ручная настройка показалась сложной, можно воспользоваться 
альтернативным графическим интерфейсом 
<a href="http://neosmart.net/dl.php?id=1">EasyBCD</a>.

<h3>Windows 7</h3>

<p>
С момента выпуска Vista Microsoft расширила BCD для того, чтобы можно было 
с помощью <tt>bcdedit</tt> загрузить несколько версий Windows. 
В связи с этим, появилось больше возможностей и используется пять команд, 
необходимых для настройки мультизагрузочной среды с OpenBSD. 

<p>
После копирования PBR OpenBSD в системный раздел Windows 7, 
используем следующую команду для инициализации реестра: 

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386" /application bootsector
The entry {0154a872-3d41-11de-bd67-a7060316bbb1} was successfully created.

C:\Windows\system32>
</pre></blockquote>

<p>
Как было указано выше, <tt>{0154a872-3d41-11de-bd67-a7060316bbb1 GUID}</tt>
является системно зависимым. Обратите внимание на значение, которое вы получаете 
при выполнении этой команды, и скопируйте его в следующие команды: 

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device partition=c:
The operation completed successfully.

C:\Windows\system32> bcdedit /displayorder {0154a872-3d41-11de-bd67-7060316bbb1} /addlast
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<h3>Другие загрузчики</h3>

<p>
Многие пользователи OpenBSD успешно используют 
<a href="http://gag.sourceforge.net/">GAG</a>,
<a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>,
<a href="http://refit.sourceforge.net/">rEFIt</a>,
и <a href="http://www.gnu.org/software/grub/">GRUB</a>.

<p>
<h3>OpenBSD и Linux (i386)</h3>
<!-- XXXversion -->

<p>
Ознакомьтесь, пожалуйста, с  
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/5.4/i386/INSTALL.linux">INSTALL.linux</a>,
в котором приведены основательные инструкции по работе OpenBSD с Linux. 

<h3>Вопросы настройки часового пояса</h3>
OpenBSD предполагает, что часы реального времени компьютера установлены в 
UTC (Всемирное координированное время). 
Некоторые другие ОС используют часы реального времени, установленные 
на местное время. Очевидно, что это может создавать небольшие проблемы, 
если вы используете две такие операционные системы на одном компьютере. 
Одну или другую из них, скорее всего, придется адаптировать. 
Дополнительная информация об этом находится в 
<a href="faq8.html#TimeZone">FAQ 8 - Почему мои часы опаздывают 
на несколько часов?</a>

<p>
<a name= "SendDmesg"></a>
<h2>4.10 - Отправка после установки вывода dmesg на dmesg@openbsd.org</h2>

<p>

Еще раз хотим напомнить, что разработчикам OpenBSD очень важно знать,
на каком железе система работает, а на каком нет (включая показания аппаратных
датчиков, находящися в машинах). 

<p>
Вот цитата из /usr/src/etc/root/root.mail:
<blockquote><pre>
Если вы хотите, чтобы OpenBSD работала лучше на ваших машинах, пожалуйста, 
окажите нам любезность (после того, как ваша почтовая система будет настроена!) 
и введите что-то вроде:
# (dmesg; sysctl hw.sensors) | \
        mail -s "Sony VAIO 505R laptop, apm works OK" dmesg@openbsd.org
таким образом, мы сможем увидеть, на машинах каких конфигураций люди работают.  
Как видно, немного информации о вашей машине, содержащейся в теме или теле письма,
может помочь нам еще больше.  Мы будем использовать эту информацию для улучшения 
поддержки драйверов устройств в будущих выпусках.  (Используйте, пожалуйста, для 
генерации dmesg прилагаемое ядро GENERIC, а не для собранное пользовательское ядро, 
за исключением случая, если вы не в состоянии загрузить ядро GENERIC.
Если у Вас многопроцессорная машина, будет приветствоваться отправка результатов 
dmesg для двух ядер: GENERIC.MP и GENERIC.)  Из этого файла мы получим информацию 
о драйвере устройства, что поможет нам исправить существующие драйверы. Спасибо!
</pre></blockquote>

<p>
Убедитесь, что вы посылаете письмо с аккаунта, на который также можно получать 
электронную почту, это нужно для того, чтобы разработчики могли связаться с вами, 
если нужно будет что-то протестировать, изменить или получить ваши рабочие 
настройки. Не важно, если письмо будет отправлено не с той же машины, на которой 
работает OpenBSD, так что, если машина не в состоянии получать электронную почту, 
просто используйте: 

<pre>
$ (dmesg; sysctl hw.sensors) | mail your-account@yourmail.dom
</pre>
а затем перенаправьте сообщение на
<pre>
 dmesg@openbsd.org
</pre>
где <tt>your-account@yourmail.dom</tt> является вашей учетной 
записью электронной почты.

<p>
<b>ПРИМЕЧАНИЯ</b>

<ul>
<li>Пожалуйста, присылайте dmesg только GENERIC ядра. 
Пользовательские ядра, из которых удалены драйверы устройств, не подходят. 
<li>Если у вас используется поддерживаемая многопроцессорная система и она 
нормально работает с ядром GENERIC.MP, разработчикам будет полезно увидеть 
вывод dmesg, как ядра GENERIC, так и ядра ​​GENERIC.MP, поэтому, пожалуйста, 
отправьте их оба в отдельных письмах. 
<li>Файлы dmesg, полученные компьютером, использующим 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">
spamd</a>, будут отклонены системой защиты от спама. Это может привести к
тому, что ваш файл dmesg в течение некоторого времени не будет принят
почтовыми серверами.
Потерпите от получаса до часа или около того и оно пройдет. 
</ul>

<p>
Описанный выше метод очень прост, однако, если вы решили не настраивать
почту на вашей системе OpenBSD, постарайтесь все равно отправить dmesg
разработчикам. Вы можете сохранить вывод dmesg в текстовый файл. 

<pre>
$ (dmesg; sysctl hw.sensors) > ~/dmesg.txt
</pre>

Затем передать этот файл (с использованием FTP/scp/дискеты/почтового голубя/ ...), 
в систему, на которой вы обычно пользуетесь электронной почтой. 
Отправляемый вами вывод dmesg, обрабатывается автоматически, поэтому убедитесь 
в следующем при использовании альтернативных почтовых клиентов/систем:
<ul>
<li>Настройте почтовый клиент для отправки сообщений в виде простого текста; 
    не используйте HTML формат электронной почты. 
<li>Выключите все функции принудительного разрыва строки. Многие почтовые клиенты 
    настроены на вставку разрыва строки на 72 столбцах (это является нормой для 
    списков рассылки). 
<li>Убедитесь, что ваш почтовый клиент не изменяет формат сообщения на "text-flow" 
    - это бессмысленно. 
<li>Не отправляйте вывод dmesg как прикрепленный файл. 
    Вставляйте вывод dmesg в тело сообщения. 
</ul>


<a name="AddFileSet"></a>
<h2>4.11 - Добавление компонентов после установки</h2>
<!-- XXXversion -->
"О, нет! Я забыл добавить набор файлов во время установки!"
<p>

Бывают случаи, когда вы понимаете, что вам действительно нужен
<tt>comp54.tgz</tt> (или любой другой из компонентов системы), но вы не
можете сейчас его установить, т.к. система уже установлена. Можем
обрадовать: есть два простых способа добавления компонентов после установки:

<h3>Использование процесса обновления</h3>

Загрузитесь с установочного носителя (CD или дискеты), выберите Upgrade
(вместо Install). Когда вы получите списки компонентов, выберите только те,
которые забыли установить в первый раз, выберите носитель, и все установится.

<h3>Использование tar(1)</h3>

Установочные компоненты - простые архивы tar, и вы можете запросто
распаковать их в корень файловой системы:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # cd /
  # tar xzvphf comp54.tgz
</pre></td></tr></table>

<p>
НЕ забывайте использовать в приведенной выше команде опцию <tt>'р'</tt>, 
которая необходима для установления правильных прав доступа к файлам! 
<p>
Одной из распространенных ошибок является уверенность в том, что вы можете 
использовать 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1">pkg_add(1)</a> 
для добавления недостающих наборов файлов. Это не сработает. pkg_add (1) 
является <a href="faq15.html#PkgMgmt">инструментом управления пакетами</a>
для установки стороннего программного обеспечения. 
Эта программа обрабатывает файлы пакета, а не обычные tar файлы, 
которыми являются установочные наборы. 

<p>
Если вы устанавливаете на вашей системе набор файлов <tt>xbase</tt> в первый 
раз, используя tar(1) и без перезагрузки, необходимо будет после установки 
обновить кэш общих библиотек при помощи 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldconfig&amp;sektion=8"
>ldconfig(8)</a> для добавления всех библиотек X в кэш: 

<blockquote><pre>
# <b>ldconfig -m /usr/X11R6/lib</b>
</pre></blockquote>

Вместо этого, вы можете просто перезагрузить систему, и это будет сделано 
автоматически сценариями запуска 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8">rc(8)</a>.

<p>
<a name="bsd.rd"></a>
<h2>4.12 - Что такое 'bsd.rd'?</h2>

<b><tt>bsd.rd</tt></b> является ядром "RAM диска".  
Этот файл может быть очень полезным; многие разработчики аккуратно
хранят его все время в корне своей системы. 

<p>
Название "ядро RAM диска" означает корневую файловую систему ядра, 
а не физического диска, а также утилиты, доступные после загрузки 
<tt>bsd.rd</tt>, которые хранятся в ядре и выполняются из файловой 
системы, расположенной в оперативной памяти. <tt>bsd.rd</tt> 
также включает в себя множество утилит, позволяющих вам обслуживать 
и устанавливать систему.

<p>
На некоторых платформах использование <tt>bsd.rd</tt> на самом деле 
является предпочтительной техникой установки - вы помещаете это ядро в 
существующую файловую систему, загружаете его и запускаете установку.  
На большинстве платформ, если у вас работает старая версия OpenBSD, 
вы можете загрузить  по FTP новую версию <tt>bsd.rd</tt>, 
перезагрузится с ним и установить новую версию OpenBSD вообще без 
использования каких-либо съемных носителей.

<p>
Вот пример загрузки <tt>bsd.rd</tt> на i386 системе:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Using Drive: 0 Partition: 3
  reading boot.....
  probing: pc0 com0 com1 apm mem[639k 255M a20=on]
  disk: fd0 hd0+
  &gt;&gt; OpenBSD/i386 BOOT 3.18
  boot&gt; <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>

<p>
Как показано выше, вы окажетесь в программе установки, но вы также сможете 
попасть в оболочку (shell), чтобы сделать обслуживание вашей системы.
<p>
Общее правило при загрузке <tt>bsd.rd</tt>, заключается в том, чтобы 
изменить загружаемое ядро с <tt>/bsd</tt> на <tt>bsd.rd</tt> 
с помощью средств, используемых на вашей платформе.

<p>
<a name="InstProb"></a>
<h2>4.13 - Возможные проблемы при установке</h2>

<a name="cpq16m"></a>
<h3>4.13.1 - Мой Compaq распознает только 16Мб RAM</h3>
<i>В некоторых</i> Compaq системах существует проблема, связанная с тем, 
что полный объем оперативной памяти системы не определяется 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">загрузчиком 
OpenBSD второй стадии</a>, а определяется и может быть использовано OpenBSD 
только 16 Мб. Это можно исправить либо путем создания/редактирования 
файла 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8&amp;arch=i386"><tt>/etc/boot.conf</tt></a>
или путем ввода команд в строке "<tt>boot></tt>" перед загрузкой 
OpenBSD.  Если у вас машина с 64 Мб оперативной памяти, но OpenBSD 
было обнаружено только первые 16Мб, вот команда, которую вам необходимо 
использовать:

<pre>
     machine mem +0x3000000@0x1000000
</pre>
для добавления 48Мб (<tt>0x3000000</tt>) после первых 16Mб 
(<tt>0x1000000</tt>).  Обычно, если у вас машина с этой проблемой, 
вы должны ввести вышеприведенную  команду сначала в строке 
<tt>boot></tt> при загрузке с дискеты/CD-ROM', затем загрузить систему, 
перезагрузиться и создать файл <tt>/etc/boot.conf</tt> с указанной выше 
командой в нем, и при всех последующих загрузках будет распознаваться 
весь доступный объем оперативной памяти.

<p>
Было также сообщение, что в обновлениях на ROM для некоторых систем 
это будет исправлено.

<p>
<a name="noboot"></a>
<h3>4.13.2 - Мой i386 не загружается после установки</h3>
Ваша установка, казалось, прошла хорошо, но при первой загрузке, вы не видите, 
что  OpenBSD пытается загрузиться.  
Есть несколько распространенных причин этой проблемы:

<ul>
<li><b>Ни один из разделов в fdisk(8) не был сделан активным.</b>  
Чтобы это исправить, перезагрузите машину, загрузитесь с помощью 
загрузочной дискеты или другого носителя, и установите необходимый 
раздел как "активный" (загрузочный).  Ознакомьтесь с 
<a href="faq14.html#fdisk">этим</a> и 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">этим</a>.
<li><b>На диске отсутствует какой-либо загрузчик.</b>  
Если при установке вы нажмете "Enter" или отвечаете «w» на вопрос 
"Использовать Весь ((W)hole) диск или Редактировать ((E)dit) MBR?" 
или использовали в fdisk(8) опцию "<tt>reinit</tt>" OpenBSD установит 
загрузочную запись ​в Главную Загрузочную Запись (MBR) диска; 
в противном случае, существующий код главной загрузочной записи остается
 нетронутым.  При отсутствии какой-либо загрузочной записи, это приведет к 
 данной проблеме. Одним из решений является загрузка с установочного 
носителя, выполнение из оболочки (shell)  команды 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>  
для обновления кода MBR из командной строки:
<pre>
    # fdisk -u wd0
</pre>
Примечание: функция "обновление" в интерактивном ("-e") режиме fdisk не 
запишет байты подписи, необходимые, для того, чтобы сделать диск загрузочным.

<li><b>В некоторых редких случаях, что-то может пойти не так на втором 
этапе установки загрузчика.</b> Переустановка второй стадии загрузчика 
обсуждается <a href="faq14.html#InstBoot">здесь</a>.

</ul>

<a name="sshhang"></a>
<h3>4.13.3 - Моя (старая, медленная) машина загрузилась, но зависла 
на этапе генерации SSH-ключей</h3>
Вполне вероятно, ваша машина работает нормально, просто, необходимо 
принять во внимание сам процесс генерации SSH-ключей.  
Этап генерации SSH-ключей
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a>) 
на SPARCStation2 или Macintosh Quadra может 
занять <i>несколько часов</i>.   
Просто дайте ему закончить - это делается только один раз за установку.

<p>
Пользователи очень медленных машин могут генерировать свои ключи на 
другом компьютере, а затем,  поместить их в файл <a href="#site">site54.tgz</a> 
и установить его вместе с остальными наборами файлов.

<p>
<a name="noftplist"></a>
<h3>4.13.4 - При установке я получил сообщение "Не удалось изменить каталог" </h3>

При использовании для установки через FTP  
<a href="faq5.html#Flavors">snapshot</a> в период <i>-beta</i> стадии 
цикла разработки OpenBSD, вы можете увидеть следующее:

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Display the list of known ftp servers? [no] <b>yes</b>
  Getting the list from 192.128.5.191 (ftp.openbsd.org)... FAILED
  Failed to change directory.
  Server IP address or hostname?
</pre></td></tr></table>

<p>
Это нормальное и ожидаемое поведение при использовании предварительной 
версии  цикла. Программа установки ищет список FTP на основном FTP сервере 
в каталоге, который не доступен до <a href="faq1.html#Next">даты 
выхода версии</a>, именно поэтому, вы получите вышеприведенное сообщение.

<p>
Просто используйте <a href="../ftp.html">список FTP серверов-зеркал</a>, 
чтобы найти подходящее вам FTP-зеркало и вручную введите его имя при запросе.

<p>
<b>Примечание: При использовании <i>-release</i> или CD-ROM, 
указанное сообщение не должно появляться.</b>

<p>
<a name="blankfdisk"></a>
<h3>4.13.5 - В моей таблице разделов fdisk какой-то мусор или она пуста!</h3>
Иногда, система нормально работает, но при выполнении <tt>fdisk wd0</tt>, 
можно увидеть совершенно пустую (или, бывает, заполненную мусором) 
таблицу разделов. Это, как правило, вызвано тем, что созданный в 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
раздел, имеет нулевое смещение секторов, а не  требуемое 
<a href="#trackoffset">смещение на один трек</a> (примечание: 
это при условии, что используется <a href="../i386.html">i386</a> или
<a href="../amd64.html">amd64</a> платформа. 
Другие платформы имеют разные требования к смещению, некоторым 
смещения не нужны).  Затем система <a href="faq14.html#Boot386">
загружается</a> с помощью PBR, не используя MBR.

<p>
Хотя эта конфигурация может работать, однако, могут возникнуть проблемы 
при обслуживании системы и поэтому ошибка должна быть исправлена. 
Чтобы исправить ситуацию, файловая система диска должна быть воссоздана 
с нуля (хотя, если вы точно знаете, что делаете, можете  восстановить
только disklabel и MBR, и тогда вы потеряете только первый OpenBSD 
раздел на диске, который нужно будет восстановить).

<p>
<a name="noflopcd"></a>
<h3>4.13.6 - На моей машине нет дискеты или CD-ROM</h3>
На некоторых компьютерах людям может понадобиться запустить OpenBSD 
при отсутствии каких-либо очевидных способов ее установки, не имея дискеты 
или компакт-диска. Либо машина была выпущена без этих устройств 
(например, многие ноутбуки и основанные на "flash" машины типа Soekris и 
ALIX системы), либо загрузочные устройства не работают должным образом 
или были удалены, а заменить их проблематично. Вот некоторые советы и 
приемы, которые можно использовать, чтобы установить OpenBSD 
на этих системах.

<ul>
<li>Сетевая загрузка с помощью <a href="faq6.html#PXE">PXE</a> 
(i386 или amd64) или 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">diskless(8)</a> 
(на других платформах).

<li>Внешний USB CD-ROM или USB дискета, если ваш компьютер может 
загружаться с них.

<li>USB флэш-диск или жесткий диск, опять же, если ваш компьютер сможет 
загрузиться с USB устройства. Подготовьте устройство на другом компьютере, 
как описано в <a href="faq14.html#flashmemLive">FAQ 14</a>. 
Загрузитесь с него, выбрав ядро bsd.rd, а затем продолжайте установку 
как обычно. Вы можете также предварительно загрузить на 
флэш-носитель наборы файлов. 

<li>В худшем случае, если ни один из вышеперечисленных способов не 
подходит, вы можете взять диск из целевой системы и, используя подходящие
 адаптеры, установить его в "нормальный" компьютер и проинсталлировать 
OpenBSD, затем верните диск обратно в целевую систему. Загрузите OpenBSD 
на целевой машине, также,  вам, скорее всего, придется настроить сеть. 
Вы можете также настроить <tt>/etc/fstab</tt>, если (к примеру) установка 
производилась с помощью USB-> IDE / SATA адаптера или ваша целевая 
или установочная машина использует 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a>.  
IDE и некоторые SATA диски нормально распознаются как  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wd&amp;sektion=4">wd(4)</a> 
устройства, но если диск подключен к адаптеру USB, он будет определен как 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sd&amp;sektion=4">sd(4)</a>. 
SATA диск, подключенный к 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pciide&amp;sektion=4">pciide(4)</a>
интерфейсу будет распознан как wd(4), но, если он подключен к 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a> 
интерфейсу, то будет определен как sd(4) устройство. Таким образом, только, 
если вы приведете в соответствие файл <tt>/etc/fstab</tt>, система будет
корректно загружаться. 

</ul>

В любом случае, помните, что на машине уже была ранее установленна 
ОС и это означает, что ОС может быть переустановлена. 
Идея о том, как установить OpenBSD, может прийти, если подумать, 
как могла быть установлена оригинальная ОС. 

<p>
<a name="shamismatch"></a>
<h3>4.13.7 - Во время установки я получил расхождение SHA256!</h3>
Контрольные суммы для наборов файлов, используемых при установке, 
встроены в установочное ядро.

<p>
В действительности, наборы файлов в <i>-release</i> должны полностью 
соответствовать своим  контрольным суммам.

<p>
<b>Время от времени, <i>snapshot</i> может не содержать в установочном 
ядре соответствующих контрольных сумм.</b>  Это может случиться по различным 
причинам при сборке и не является причиной для паники. 
Если для вас это важно, дождитесь следующего snapshot.

<p>
<a name="site"></a>
<h2>4.14 - Настройка процесса установки</h2>
<!-- XXXversion -->

<h3>файл <tt>siteXX.tgz</tt></h3>
Сценарии установки/обновления OpenBSD позволяют выбрать созданный 
пользователем установочный набор, который называется "<tt>siteXX.tgz</tt>", 
где XX это релиз версии (например, 54).  Установочный набор 
<tt>siteXX.tgz</tt>, как и другие наборы файлов, представляет собой сжатый 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gzip&amp;sektion=1">gzip(1)</a>  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a> 
архив с источником в '/' и, который, как и другие 
<a href="#FilesNeeded">наборы</a>, распаковывается с опциями 
<tt>xzphf</tt>.  Этот набор будет установлен последним, после установки 
всех других наборов файлов.

<p>
Этот набор файлов позволяет пользователям добавлять и/или переопределять 
файлы, установленные в «нормальных» наборах и, таким образом, 
настроить установку или обновление.

<p>
Вы также можете создавать и использовать системно-зависимые наборы 
файлов, которые будут называться 
<tt>siteXX-<i>&lt;hostname&gt;.tgz</i></tt>, например, 
"<tt>site54-puffy.tgz</tt>". 
Это позволяет использовать предназначенные для конкретного хоста 
настройки установки, обновления или аварийного восстановления.

<p>
Вот  некоторые примеры использования файла <tt>siteXX.tgz</tt>:
<ul>
<li>Создайте файл siteXX.tgz, который будет содержать все измененные 
вами в начальной установке OpenBSD файлы. Затем, если вы захотите
воссоздать такую же систему, просто выберите siteXX.tgz во время повторной 
установки и все изменения реплицируются на новую систему.

<li>Можно создать каталоги для определенных типов машин, которые будут 
содержать файл siteXX.tgz, специфичный для конкретного типа машин. 
Установка машин (например, с различными видеокартами) из определенной
 категории может быть сделана путем выбора соответствующего 
файла siteXX.tgz.

<li>Поместите в siteXX.tgz файлы, которые вы регулярно изменяете, 
таким же или аналогичным образом -- файлы из 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8"
><tt>/etc/skel</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"
><tt>/etc/pf.conf</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"
><tt>/var/www/conf/httpd.conf</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8"
><tt>/etc/rc.conf.local</tt></a>, и т. д.
</ul>

<h3>сценарии <tt>install.site</tt>/<tt>upgrade.site</tt></h3>
В качестве последнего шага в процессе установки/обновления, сценарии ищут
 в корневом каталоге вновь установленную/обновленую систему для 
<tt>install.site</tt> или <tt>upgrade.site</tt>, в соответствии с текущим 
процесс, и запускают этот сценарий в  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=8">изолированном (chrooted)</a>
окружении для установки/обновления корня системы.  Помните, что 
обновление выполняется из загруженной файловой системы, в связи с этим, 
ваша целевая файловая система на самом деле смонтирована в <tt>/mnt</tt>. 
Однако, в связи с использованием chroot, ваш скрипт может быть написан 
как будто он работает в "нормальном" корне вашей файловой системы.  
Так как этот скрипт запускается после того, как все файлы будут установлены, 
у вас есть доступ к многим функциональным возможностям полной системы 
для выполнения скрипта. Имейте в виду, что вы работаете с минимальным 
ядром, не все функции доступны, и из-за нехватки места, то, что работает
сегодня, может не работать в будущих версиях.

<p>
Обратите внимание, что сценарий <tt>install.site</tt> должен находиться в 
файле <tt>siteXX.tgz file</tt>, в то время, как сценарий 
<tt>upgrade.site</tt> может быть помещен в корневой каталог до 
обновления или в файл <tt>siteXX.tgz</tt>.

<p>
Сценарии могут быть использованы для многих вещей:
<ul>
<li>Удаление файлов, которые установлены/обновлены, если вы не хотите, 
чтобы они находились  в системе.
<li> Удаление/обновление/установка <a href="faq15.html#PkgMgmt">пакетов
</a> в установленной системе (может не работать для всех пакетов!).
<li> <a href="faq14.html#Backup">Безотлагательное резервное 
копирование/архивация</a>  новой системы перед открытием ее внешнему миру.
<li>Использование 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate(8)</a>
для установки системного времени.
<li>Существует набор произвольных команд, запускаемых после первой 
загрузки. Это произойдет, если install.site используется для добавления таких 
команд в файл 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.firsttime&amp;sektion=8">rc.firsttime(8)</a> 
(добавление в этот файл необходимо, установщик, также, сам может 
записывать в этот файл). Во время загрузки, rc.firsttime выполняется 
один раз и затем удаляется.

</ul>

<p>
Сочетание <tt>siteXX.tgz</tt> и файлов <tt>install.site/upgrade.site</tt> 
предназначено для того, чтобы предоставить пользователям широкие 
возможности настройки без необходимости создавать свои собственные 
пользовательские установочные наборы.

<p>
Примечание: если вы будете осуществлять установку с HTTP-сервера, 
вам будет нужно добавить ваш <tt>site*.tgz</tt> файл(ы) в 
<tt>index.txt</tt>, расположенный в исходном каталоге, для того, 
чтобы они были видны как опции во время установки. Это не является 
необходимым при использовании FTP или других способов установки.

<p>
<a name="Multiple"></a>
<h2>4.15 - Как установить несколько одинаковых систем?</h2>
Здесь приведены некоторые инструменты, которые можно использовать 
для установки нескольких одинаковых систем OpenBSD.

<h3>файлы <tt>siteXX.tgz</tt> и <tt>install/upgrade.site</tt></h3>
См.<a href="#site"> выше</a>.

<h3>Восстановление из dump(8)</h3>
На большинстве платформ, загрузочный носитель включает в себя программу 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>,  
которая может быть использована для восстановления из резервной 
копии, сделанной 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>. 
Таким образом, вы можете загрузиться с 
<a href="#MkFlop">floppy</a>, 
<a href="../orders.html">CD</a> или 
файла <a href="#bsd.rd">bsd.rd</a>, 
а затем <a href="faq14.html#fdisk">fdisk</a>, 
<a href="faq14.html#disklabel">disklabel</a>, и 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">восстановить</a> 
нужную конфигурацию с ленты или другого носителя, и установить 
<a href="faq14.html#InstBoot">загрузочные блоки</a>. Подробнее 
<a href="faq14.html#Backup">здесь</a>.

<h3>Образы диска</h3>
К сожалению, не известно о существовании пакетов для создания образов 
дисков, которые могут работать с файловой системой FFS и делать ее образы, 
содержащие только активные файловые пространства. Большинство основных
 решений в области создания образов диска будут работать с разделом 
OpenBSD, как с "общим" разделом, и могут сделать образ всего диска. 
Эти программы выполняют свою задачу, но, обычно, с огромным количеством 
пустого пространства -- пустой 10Гб раздел <tt>/home</tt> займет также 
10Гб пространства в созданном образе, даже если там нет ни одного файла. 
 Этот образ диска вы, как правило, сможете установить на больший диск, но,
 при этом, не будете иметь возможности напрямую использовать 
дополнительное пространство, и не сможете установить этот 
образ на меньший диск.

<p>
Если эта ситуация приемлема в вашем случае, тогда вам подойдет команда 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd</a>, 
позволяющая скопировать один диск на другой, сектор в сектор.  
Это позволяет обеспечить такую ​​же функциональность, как у коммерческих 
программ без каких-либо затрат.

<p>
<a name="getdmesg"></a>
<h2>4.16 - Как получить вывод dmesg(8), чтобы сообщить о проблеме при установке?</h2>
При <a href="../../ru/report.html">сообщении о проблеме</a>, решающее 
значение имеет наличие полного системного 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>. 
Однако, часто вам нужно это сделать, в связи с тем, что система неправильно 
работает или не устанавливается и, таким образом, вы можете не иметь 
доступа к диску, сети, или другим ресурсам, необходимым для получения 
dmesg для соответствующего <a href="../mail.html">списка рассылки</a>. 
Конечно, есть и другие способы его получения:

<ul>
<li><b>Дискета:</b>  На загрузочных дисках и CD-ROM находится 
достаточно инструментов для записи вашего dmesg на дискету MS-DOS, 
которую можно затем использовать на другой машине для получения dmesg. 
Поместите отформатированную для MSDOS дискету в дисковод и 
выполните следующие команды:

<pre>
     mount -t msdos /dev/fd0a /mnt
     dmesg >/mnt/dmesg.txt
     umount /mnt
</pre>
Если у вас есть другая система OpenBSD, вы также можете записать его на 
OpenBSD совместимую дискету - часто, загрузочная дискета имеет достаточно 
места  для сохранения dmesg.  В этом случае, нужно в команде выше 
убрать "<tt>-t msdos</tt>".

<p>
<li><b>Последовательная консоль:</b>
Использование последовательной консоли и захват вывода на другой 
компьютер часто является лучшим способом получения диагностической 
информации - в частности, при ситуации, если компьютер начинает 
"паниковать" сразу после загрузки. Вместе со вторым компьютером, вам 
необходим подходящий последовательный кабель (обычно, нуль-модемный 
кабель), а также программа эмулятора терминала, которая может 
захватывать экран вывода в файл.

<p>
Общая информация о настройке последовательной консоли приведена в 
<a href="faq7.html#SerCon">другом месте FAQ</a>; для того, 
чтобы захватить вывод журнала установки, обычно, достаточно 
следующих команд.

<p><b>i386</b>

<p>
В строке приглашения загрузчика, введите

<p>
<blockquote>
<pre>
boot> <b>set tty com0</b>
</pre>
</blockquote>

<p>
Это укажет OpenBSD использовать первый последовательный порт 
(часто называемый  в документации PC COM1 или COMA) в качестве 
последовательной консоли. По умолчанию используется скорость 9600 бод.

<p><b>Sparc/Sparc64</b>

<p>
Эти машины будут автоматически использовать последовательную консоль, 
если были запущены  без клавиатуры. Если у вас подключены клавиатура и 
монитор, вы все равно можете заставить систему использовать 
последовательную консоль с помощью следующего вызова в строке 
<tt>ok</tt>.

<p>
<blockquote>
<pre>
ok <b>setenv input-device ttya</b>
ok <b>setenv output-device ttya</b>
ok <b>reset</b>
</pre>
</blockquote>

</ul>
<p>

<font color= "#0000e0">
<a href= "index.html">[FAQ-Index]</a>
<a href= "faq3.html">[Глава 3 - Начинаем работать с OpenBSD]</a>
<a href= "faq5.html">[Глава 5 - Сборка системы из исходников]</a>
</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt= "[back]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq4.html,v 1.327 ]<br>
$Translation: faq4.html,v 1.3 2013/11/01 22:31:18 alex Exp $<br>
-->
$OpenBSD$
</small>

</body>
</html>
